// layerJS 0.5.2
// https://github.com/layerJS/layerJS
// contact us at developers@layerjs.org
// (c) 2017 - 2018
// this is open-source software. some restrictions apply.
// see https://github.com/layerJS/layerJS/blob/master/LICENSE
// branch: master
// commit: 7244a5cedca8419d2b2a6eada8718309426cf429


var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,h,k){f!=Array.prototype&&f!=Object.prototype&&(f[h]=k.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var f=0;return function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+f++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(f){var h=0;return $jscomp.iteratorPrototype(function(){return h<f.length?{done:!1,value:f[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};$jscomp.iteratorFromArray=function(f,h){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var k=0,g={next:function(){if(k<f.length){var e=k++;return{value:h(e,f[e]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(f,h,k,g){if(h){k=$jscomp.global;f=f.split(".");for(g=0;g<f.length-1;g++){var e=f[g];e in k||(k[e]={});k=k[e]}f=f[f.length-1];g=k[f];h=h(g);h!=g&&null!=h&&$jscomp.defineProperty(k,f,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.keys",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
$jscomp.checkStringArgs=function(f,h,k){if(null==f)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return f+""};
$jscomp.polyfill("String.prototype.startsWith",function(f){return f?f:function(f,k){var g=$jscomp.checkStringArgs(this,f,"startsWith");f+="";var e=g.length,c=f.length;k=Math.max(0,Math.min(k|0,g.length));for(var b=0;b<c&&k<e;)if(g[k++]!=f[b++])return!1;return b>=c}},"es6","es3");$jscomp.polyfill("Number.parseFloat",function(f){return f||parseFloat},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(f,k){var g=$jscomp.checkStringArgs(this,f,"endsWith");f+="";void 0===k&&(k=g.length);k=Math.max(0,Math.min(k|0,g.length));for(var e=f.length;0<e&&0<k;)if(g[--k]!=f[--e])return!1;return 0>=e}},"es6","es3");
(function e$jscomp$0(f,h,k){function e(a,b){if(!h[a]){if(!f[a]){var m="function"==typeof require&&require;if(!b&&m)return m(a,!0);if(c)return c(a,!0);b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b;}b=h[a]={exports:{}};f[a][0].call(b.exports,function(b){var d=f[a][1][b];return e(d?d:b)},b,b.exports,e$jscomp$0,f,h,k)}return h[a].exports}for(var c="function"==typeof require&&require,b=0;b<k.length;b++)e(k[b]);return e})({1:[function(f,h,k){var g=f("./domhelpers.js"),e=f("./pluginmanager.js"),
c=f("./parsemanager.js"),b=f("./observer/domobserver.js");f=b.extend({constructor:function(a){a=a||{};b.call(this);this._cache={};this.childType=a.childType;this._setDocument(a);this.parent=a.parent;this.innerEl=this.innerEl||a.el;if(this.innerEl._ljView)throw"trying to initialialize view on element that already has a view";this.innerEl._ljView=this;this.outerEl=this.outerEl||a.el||this.innerEl;this.outerEl._ljView=this;this.setOriginalHeight();this.setOriginalWidth();this._parseChildren();this.registerEventHandlers();
this.startObserving()},startObserving:function(){},registerEventHandlers:function(){this.on("childrenChanged",function(a){(a.addedNodes&&0<a.addedNodes.length||a.removedNodes&&0<a.removedNodes.length)&&this._parseChildren({addedNodes:a.addedNodes,removedNodes:a.removedNodes})})},_parseChildren:function(a){a=a||{};var b=this;this._cache.children=[];this._cache.childNames={};this._cache.childIDs={};a.removedNodes&&0<a.removedNodes.length&&a.removedNodes.forEach(function(d){d._ljView&&b.trigger("childRemoved",
d._ljView)});var p={};if(this.childType)for(var l=0;l<this.innerEl.children.length;l++){var d=this.innerEl.children[l];d._ljView||g.getAttributeLJ(d,"type")!==this.childType||(e.createView(this.childType,{el:d,parent:this,document:this.document}),this._renderChildPosition(d._ljView),this.trigger("childAdded",d._ljView),p[d._ljView.id()]=1);d._ljView&&d._ljView.type()===this.childType&&(d=d._ljView,this._cache.children.push(d),this._cache.childNames[d.name()]=d,this._cache.childIDs[d.id()]=d)}l=!1;
if(a.addedNodes&&0<a.addedNodes.length){d=a.addedNodes.length;for(var n=0;n<d;n++)a.addedNodes[n].parentElement===this.innerEl&&(a.addedNodes[n]._ljView?a.addedNodes[n]._ljView.parent!==this&&(a.addedNodes[n]._ljView.parent=this):l||(c.parseElement(a.addedNodes[n].parentNode,{parent:this}),l=!0),a.addedNodes[n]._ljView&&!p[a.addedNodes[n]._ljView.id()]&&this.trigger("childAdded",a.addedNodes[n]._ljView))}},getChildViewByName:function(a){this._cache.childNames||this._parseChildren();return this._cache.childNames[a]},
getChildViews:function(){this._cache.children||this._parseChildren();return this._cache.children},_setDocument:function(a){this.document=document;a&&(a.document?this.document=a.document:a.el&&(this.document=a.el.ownerDocument))},_renderChildPosition:function(a){},applyStyles:function(){for(var a=arguments.length,b=0;b<a;b++)for(var e=Object.keys(arguments[b]),c=0;c<e.length;c++)g.cssPrefix[e[c]]&&(this.outerEl.style[g.cssPrefix[e[c]]]=arguments[b][e[c]]),this.outerEl.style[e[c]]=arguments[b][e[c]]},
setAttributeLJ:function(a,b){g.setAttributeLJ(this.outerEl,a,b)},getAttributeLJ:function(a){return g.getAttributeLJ(this.outerEl,a)},getAttribute:function(a){return this.outerEl.getAttribute(a)},id:function(){this._id||(this._id=this.getAttributeLJ("id")||this.outerEl.id||g.uniqueID(this.type(),this.document));return this._id},name:function(){var a=this.getAttributeLJ("name")||this.id();if(a.match(/\./)){if(this._name)return this._name;console.warn('unsuitable layerJS name "'+a+'" replaced by "'+
(this._name=a=g.uniqueID(this.type(),this.document))+'"')}this._name&&(this._name=a);return a},type:function(){return this.getAttributeLJ("type")},nodeType:function(){return this.outerEl&&this.outerEl.nodeType},width:function(){var a=this.getAttributeLJ("width")||this.getAttribute("width");null!==a?this.setWidth(a):a=this.outerEl.offsetWidth||this.outerEl.style.width||0;return g.parseDimension(a,this.outerEl)},height:function(){var a=this.getAttributeLJ("height")||this.getAttribute("height");null!==
a?this.setHeight(a):a=this.outerEl.offsetHeight||this.outerEl.style.height||0;return g.parseDimension(a,this.outerEl)},setWidth:function(a){a=g.parseDimension(a,this.outerEl);var b=this.getMargin();this.outerEl.style.width=a-(b.left+b.right)+"px"},setHeight:function(a){a=g.parseDimension(a,this.outerEl);var b=this.getMargin();this.outerEl.style.height=a-(b.top+b.bottom)+"px"},x:function(){var a=this.getAttributeLJ("x");a=a||this.outerEl.offsetLeft||this.outerEl.style.left||0;return g.parseDimension(a,
this.outerEl)},y:function(){var a=this.getAttributeLJ("y");a=a||this.outerEl.offsetTop||this.outerEl.style.top||0;return g.parseDimension(a)},scaleX:function(){var a=this.getAttributeLJ("scale")||this.getAttributeLJ("scale-x");return a?parseFloat(a):1},scaleY:function(){var a=this.getAttributeLJ("scale")||this.getAttributeLJ("scale-y");return a?parseFloat(a):1},fitTo:function(a){var b=this.getAttributeLJ("fit-to");!1===a||b||(b="width");return b},elasticLeft:function(){return this.getAttributeLJ("elastic-left")},
elasticRight:function(){return this.getAttributeLJ("elastic-right")},elasticTop:function(){return this.getAttributeLJ("elastic-top")},elasticBottom:function(){return this.getAttributeLJ("elastic-bottom")},startPosition:function(){return this.getAttributeLJ("start-position")||"top-left"},noScrolling:function(){var a=this.getAttributeLJ("no-scrolling");return a?"true"===a:!1},rotation:function(){return this.getAttributeLJ("rotation")},neighbors:function(){return{l:this.getAttributeLJ("neighbors.l"),
r:this.getAttributeLJ("neighbors.r"),t:this.getAttributeLJ("neighbors.t"),b:this.getAttributeLJ("neighbors.b")}},layoutType:function(){return this.getAttributeLJ("layout-type")||this.getAttributeLJ("layout")||"slide"},defaultFrame:function(){return this.getAttributeLJ("default-frame")},defaultTransition:function(){return this.getAttributeLJ("transition")},nativeScroll:function(){var a=this.getAttributeLJ("native-scroll");return a?"true"===a:!0},setNativeScroll:function(a){this.setAttributeLJ("native-scroll",
a)},getMargin:function(){var a=window.getComputedStyle(this.outerEl,null);return{top:g.parseDimension(a.getPropertyValue("margin-top")||"0"),bottom:g.parseDimension(a.getPropertyValue("margin-bottom")||"0"),right:g.parseDimension(a.getPropertyValue("margin-right")||"0"),left:g.parseDimension(a.getPropertyValue("margin-left")||"0")}},noUrl:function(){return"true"===this.getAttributeLJ("no-url")?!0:!1},timer:function(){return this.getAttributeLJ("timer")},autoHeight:function(){return this.getAttributeLJ("auto-height")},
autoWidth:function(){return this.getAttributeLJ("auto-width")},draggable:function(){return"true"===this.getAttributeLJ("draggable")?!0:!1},destroy:function(){this.unobserve();this.outerEl.parentNode.removeChild(this.outerEl)},setOriginalWidth:function(){this.originalWidth=this.outerEl.style.width},getOriginalWidth:function(){return this.originalWidth||""},setOriginalHeight:function(){this.originalHeight=this.outerEl.style.height},getOriginalHeight:function(){return this.originalHeight||""}});h.exports=
f},{"./domhelpers.js":3,"./observer/domobserver.js":14,"./parsemanager.js":21,"./pluginmanager.js":22}],2:[function(f,h,k){h.exports={version:"default",defaultDuration:"1s",transitionParameters:{duration:"t",type:"p",delay:"d"},identifyPriority:{low:1,normal:2,high:3},directions2neighbors:{up:"b",down:"t",left:"r",right:"l"},neighbors2transition:{b:"auto:up",t:"auto:down",r:"auto:left",l:"auto:right"},specialFrames:{none:"!none",left:"!left",right:"!right",top:"!top",bottom:"!bottom",next:"!next",
previous:"!prev",default:"!default",current:"!current"}}},{}],3:[function(f,h,k){var g=f("./defaults.js"),e=f("./tmat.js"),c=null,b={wrapChildren:function(a,b){b=b||{};for(b=a.ownerDocument.createElement(b.tag||"div");a.childNodes.length;)b.appendChild(a.childNodes[0]);a.appendChild(b);return b},unwrapChildren:function(a){for(var b=a.removeChild(a.children[0]);b.childNodes.length;)a.appendChild(b.childNodes[0])},addClass:function(a,b){a.className+=(a.className?" ":"")+b},removeClass:function(a,b){a.className=
a.className.replace(new RegExp("(?:\\s+|^)"+b+"(?:\\s+|$)"),"")},detectBrowser:function(){var a;"undefined"===typeof navigator?this.browser="node":(a=navigator.userAgent.match(/Edge\/([0-9]*)/))?(this.vendorPrefix="-ms-",this.browserVersion=a[1],this.browser="edge"):(a=navigator.userAgent.match(/MSIE ([0-9]*)/))?(this.vendorPrefix="-ms-",this.browserVersion=a[1],this.browser="ie"):(a=navigator.userAgent.match(/Trident.*rv:([0-9]*)/))?(this.vendorPrefix="-ms-",this.browserVersion=a[1],this.browser=
"ie"):(a=navigator.userAgent.match(/Chrome\/([0-9]*)/))?(this.vendorPrefix="-webkit-",this.browserVersion=a[1],this.browser="chrome"):(a=navigator.userAgent.match(/Firefox\/([0-9]*)/))?(this.vendorPrefix="",this.browserVersion=a[1],this.browser="firefox"):navigator.userAgent.match(/iPad|iPhone|iPod/)?(this.vendorPrefix="-webkit-",this.browserVersion=0,this.browser="ios"):(a=navigator.userAgent.match(/Safari\/([0-9]*)/))?(this.vendorPrefix="-webkit-",this.browserVersion=a[1],this.browser="safari"):
navigator.userAgent.match(/AppleWebKit/)&&(this.vendorPrefix="-webkit-",this.browserVersion=0,this.browser="webkit")},calculatePrefixes:function(a){this.cssPrefix=this.cssPrefix||{};for(var b=0;b<a.length;b++)this.cssPrefix[a[b]]=this.vendorPrefix&&this.vendorPrefix+a[b]||a[b]},postAnimationFrame:function(a){(window.requestAnimationFrame||function(a){setTimeout(a,1E3/60)})(function(){setTimeout(a,0)})},selectView:function(a){a=a instanceof HTMLElement?[a]:document.querySelectorAll(a);for(var b=0;b<
a.length;b++)if(a[b]._ljView)return a[b]._ljView},addDelegtedListener:function(a,b,e,c){window.Element.prototype.matches||(window.Element.prototype.matches=window.Element.prototype.matchesSelector||window.Element.prototype.mozMatchesSelector||window.Element.prototype.msMatchesSelector||window.Element.prototype.oMatchesSelector||window.Element.prototype.webkitMatchesSelector||function(d){d=(this.document||this.ownerDocument).querySelectorAll(d);for(var a=d.length;0<=--a&&d.item(a)!==this;);return-1<
a});a.addEventListener(b,function(d){for(var b=d.target;b!==a&&!b.matches(e);)b=b.parentNode;b!==a&&c.call(b,d)})},comparePosition:function(a,b){if(a===b)return 0;if(!a.compareDocumentPosition)return a.sourceIndex-b.sourceIndex;a=a.compareDocumentPosition(b);if(a&window.Node.DOCUMENT_POSITION_DISCONNECTED)throw"compare position: the two elements belong to different documents";return a&window.Node.DOCUMENT_POSITION_PRECEDING||a&window.Node.DOCUMENT_POSITION_CONTAINS?1:-1},getAttributeLJ:function(a,
b){return a.getAttribute("data-lj-"+b)||a.getAttribute("lj-"+b)},hasAttributeLJ:function(a,b){return a.hasAttribute("data-lj-"+b)||a.hasAttribute("lj-"+b)},setAttributeLJ:function(a,b,e){b="lj-"+b;a.getAttribute("data-"+b)?a.setAttribute("data-"+b,e):a.setAttribute(b,e)},findParentViewOfType:function(a,b){a=a.parentElement;for(var e=!1;a&&!e;)a._ljView&&a._ljView.type()===b?e=!0:a=a.parentElement;return e?a._ljView:void 0},timeToMS:function(a){a=a&&a.match(/^([\d\.]*)(s|ms|min|h)$/);if(!a)return 0;
switch(a[2]){case "ms":return a[1];case "s":return 1E3*a[1];case "min":return 6E4*a[1];case "h":return 36E5*a[1]}return 0},parseDimension:function(a,b){if(!isNaN(Number(a)))return Number(a);if(a.match(/px$/))return parseInt(a);if(a.match(/em$/))return parseInt(a)*parseInt(window.getComputedStyle(b)["font-size"]);if(a.match(/vh$/))return parseInt(a)*window.innerHeight/100;if(a.match(/vw$/))return parseInt(a)*window.innerWidth/100},uniqueID:function(a,b){b=b||document;void 0===b._ljUniqueHash&&(b._ljUniqueHash=
{});b=b._ljUniqueHash;a=a||-1;void 0===b[a]&&(b[a]=-1);return-1!==a?a+"["+ ++b[a]+"]":++b[a]},debug:function(){null===c&&(c=document&&document.body&&b.getAttributeLJ(document.body,"debug")?!0:!1);c&&console.log.apply(console,arguments)},splitUrl:function(a){a=a.match(/^([^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/);return{location:a[1],queryString:a[2],hash:a[3]}},joinUrl:function(a,b){var e=(a.location?a.location:"")+(a.queryString?"?"+a.queryString:"");!0!==b&&(e+=a.hash?"#"+a.hash:"");return e},parseStringForTransitions:function(a,
b){var e={};if(a)for(var c in g.transitionParameters)if(g.transitionParameters.hasOwnProperty(c)){var d=new RegExp("(?:^|[?&])"+g.transitionParameters[c]+"=([^&]+)"),n=a.match(d);n&&(e[c]=n[1],!0!==b&&(a=a.replace(d,"")))}return{string:a,transition:e}},getAbsoluteUrl:function(){var a=document.createElement("a");return function(b){a.href=b;return a.href}}(),_parents:function(a){for(var b=[a];a;a=a.parentNode)b.unshift(a);return b},commonParent:function(a,b){a=this._parents(a);b=this._parents(b);if(a[0]!==
b[0])return null;for(var e=0;e<a.length;++e)if(a[e]!==b[e])return a[e-1];return null},getMatrixArray:function(a){a=window.getComputedStyle(a,null);a=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform")||"FAIL";if("none"===a||void 0===a||"FAIL"===a)a=[1,0,0,1,0,0];else{a=a.toLowerCase();var b=a.split("(")[1].split(")")[0].split(",").map(function(a){return parseFloat(a.replace(/\s+/g,
""))}),e=b[0],c=b[1],d=b[2],n=b[3],q=b[4],f=b[5];a.startsWith("matrix3d(")&&(e=b[0],c=b[1],d=b[4],n=b[5],q=b[12],f=b[13]);a=[e,c,d,n,q,f]}return a},getMatrix:function(a){var b=new e(this.getMatrixArray(a));return b=this.getTopLeftMatrix(a).prod(b)},getScaleAndRotationMatrix:function(a){a=new e(this.getMatrixArray(a));a.tx=a.ty=0;return a},applyTopLeftOnMatrix:function(a,b){var e=b.get_rotation_equal();e%=360;a=a.getBoundingClientRect();var c=a.width,d=a.height;var n=a.top;var q=a.left;if(0<e&&90>=
e||-270>e&&-360<=e)e=e*Math.PI/180*-1,n=a.top,q=a.left-Math.sin(e)*d;else if(90<e&&180>=e||-180>e&&-270<=e)n=(180-e)*Math.PI/180,q=e*Math.PI/180,n=a.top-Math.cos(n)*d*-1,q=a.left+(Math.sin(q)*d+-1*Math.cos(q)*c);else if(0>e&&-90<=e||270<e&&360>=e)e=-e*Math.PI/180,n=a.top+Math.sin(e)*c,q=a.left;else if(-90>e&&-180<=e||180<e&&270>=e)q=(180-e)*Math.PI/180,n=-e*Math.PI/180,q=a.left+Math.cos(q)*c,n=a.top+(Math.sin(n)*c+-1*Math.cos(n)*d);b.tx=q;b.ty=n;return b}};b.detectBrowser();b.calculatePrefixes(["transform",
"transform-origin"]);h.exports=b},{"./defaults.js":2,"./tmat.js":31}],4:[function(f,h,k){k=f("./pluginmanager.js");var g=f("./domhelpers.js"),e=f("./baseview.js");f=f("./defaults.js");var c=e.extend({constructor:function(b){this.renderRequiredAttributes="lj-fit-to lj-elastic-left lj-elastic-right lj-elastic-top lj-elastic-bottom lj-width lj-height lj-x lj-y lj-scale-x lj-scale-y lj-rotation lj-start-position".split(" ");this.transformData=void 0;e.call(this,b);this.originalParent=this.parent},startObserving:function(){e.prototype.observe.call(this,
this.innerEl,{attributes:!0,attributeFilter:["name","lj-name","id"].concat(this.renderRequiredAttributes),children:!0,size:!0})},registerEventHandlers:function(){var b=this;e.prototype.registerEventHandlers.call(this);this.on("sizeChanged",function(){b.parent&&(b.inTransition?(b.inTransitionListening||setTimeout(function m(){b.inTransition?setTimeout(m,100):(b.inTransitionListening=!1,b.trigger("renderRequired",b.name()))},100),b.inTransitionListening=!0):b.trigger("renderRequired",b.name()))});this.on("attributesChanged",
this.attributesChanged)},attributesChanged:function(b){for(var a=0;a<this.renderRequiredAttributes.length;a++){var e=Object.getOwnPropertyNames(b);if(-1!==e.indexOf(this.renderRequiredAttributes[a])||-1!==e.indexOf("data-"+this.renderRequiredAttributes[a])){this.trigger("renderRequired",this.name());break}}},getTransformData:function(b,a,e){var c=this.transformData;if(!c||c.isDirty||c.layer!==b||a&&a!==c.startPosition)return c&&delete c.isDirty,this.unobserve(),this.transformData=this.calculateTransformData(b,
a),this.startObserving(),this.transformData;e||(c.scrollX=c.initialScrollX,c.scrollY=c.initialScrollY);return c},getScrollData:function(){return this.transformData?{scrollX:this.transformData.scrollX,scrollY:this.transformData.scrollY}:{}},calculateTransformData:function(b,a){var e=b.parent,c=e?e.width():0,f=e?e.height():0,d=this.transformData={};d.stage=e;d.layer=b;d.scale=1;d.frameWidth=this.width();d.frameHeight=this.height();d.shiftX=0;d.shiftY=0;d.scrollX=0;d.scrollY=0;d.isScrollX=!1;d.isScrollY=
!1;b=this.fitTo(!1)||b.fitTo();switch(b){case "width":d.scale=c/d.frameWidth;d.isScrollY=!0;break;case "height":d.scale=f/d.frameHeight;d.isScrollX=!0;break;case "fixed":d.scale=1;d.isScrollX=!0;d.isScrollY=!0;break;case "contain":d.scaleX=c/d.frameWidth;d.scaleY=f/d.frameHeight;d.scaleX<d.scaleY?(d.scale=d.scaleX,d.isScrollY=!0):(d.scale=d.scaleY,d.isScrollX=!0);break;case "cover":d.scaleX=c/d.frameWidth;d.scaleY=f/d.frameHeight;d.scaleX>d.scaleY?(d.scale=d.scaleX,d.isScrollY=!0):(d.scale=d.scaleY,
d.isScrollX=!0);break;case "elastic-width":c<=d.frameWidth&&c>=d.frameWidth-this.elasticLeft()-this.elasticRight()?(d.scale=1,d.shiftX=this.elasticLeft()*(d.frameWidth-c)/(parseInt(this.elasticLeft())+parseInt(this.elasticRight()))):c>d.frameWidth?d.scale=c/d.frameWidth:(d.scale=c/(d.frameWidth-this.elasticLeft()-this.elasticRight()),d.shiftX=this.elasticLeft());d.isScrollY=!0;break;case "elastic-height":f<=d.frameHeight&&f>=d.frameHeight-this.elasticTop()-this.elasticBottom()?(d.scale=1,d.shiftY=
this.elasticTop()*(d.frameHeight-f)/(parseInt(this.elasticTop())+parseInt(this.elasticBottom()))):f>d.frameHeight?d.scale=f/d.frameHeight:(d.scale=f/(d.frameHeight-this.elasticTop()-this.elasticBottom()),d.shiftY=this.elasticTop());d.isScrollY=!0;break;case "responsive":d.scale=1;d.frameWidth=c;d.applyWidth=!0;d.applyHeight=!0;d.frameHeight=f;break;case "responsive-width":d.scale=1;d.isScrollY=!0;d.applyWidth=!0;d.frameWidth=c;break;case "responsive-height":d.scale=1;d.isScrollX=!0;d.applyHeight=
!0;d.frameHeight=f;break;default:throw"unkown fitTo type '"+b+"'";}if(d.isScrollY&&e.autoWidth())throw"we can't adapt stage width if we fit to width";if(d.isScrollX&&e.autoHeight())throw"we can't adapt stage height if we fit to height";d.width=d.frameWidth*d.scale;d.height=d.frameHeight*d.scale;e&&e.autoWidth()?c=d.width:e&&e.autoHeight()&&(f=d.height);d.maxScrollY=0;d.maxScrollX=0;d.isScrollY&&(d.maxScrollY=d.frameHeight-f/d.scale);d.isScrollX&&(d.maxScrollX=d.frameWidth-c/d.scale);d.startPosition=
a||this.startPosition();a={top:["top","center"],bottom:["bottom","center"],left:["left","middle"],right:["right","middle"],"top-left":["top","left"],"top-right":["top","right"],"bottom-left":["bottom","left"],"bottom-right":["bottom","right"],"middle-center":["middle","center"],middle:["middle","center"],center:["middle","center"]}[d.startPosition];for(e=0;e<a.length;e++)switch(a[e]){case "top":d.isScrollY&&(d.scrollY=0);break;case "bottom":d.isScrollY&&(d.scrollY=d.maxScrollY,0>d.scrollY&&(d.shiftY=
d.scrollY,d.scrollY=0));break;case "left":d.isScrollX&&(d.scrollX=0);break;case "right":d.isScrollX&&(d.scrollX=d.maxScrollX,0>d.scrollX&&(d.shiftX=d.scrollX,d.scrollX=0));break;case "center":d.isScrollX&&(d.scrollX=(d.frameWidth-c/d.scale)/2,0>d.scrollX&&(d.shiftX=d.scrollX,d.scrollX=0));break;case "middle":d.isScrollY&&(d.scrollY=(d.frameHeight-f/d.scale)/2,0>d.scrollY&&(d.shiftY=d.scrollY,d.scrollY=0));break;default:d.isScrollX&&(d.scrollX=0),d.isScrollY&&(d.scrollY=0)}0>=d.maxScrollX&&(d.shiftX+=
d.scrollX,d.scrollX=0,d.maxScrollX=0,d.isScrollX=!1);0>=d.maxScrollY&&(d.shiftY+=d.scrollY,d.scrollY=0,d.maxScrollY=0,d.isScrollY=!1);this.noScrolling()&&(d.shiftX+=d.scrollX,d.shiftY+=d.scrollY,d.scrollX=0,d.scrollY=0,d.isScrollX=!1,d.isScrollY=!1,d.maxScrollX=0,d.maxScrollY=0);d.shiftX*=d.scale;d.shiftY*=d.scale;d.initialScrollX=d.scrollX;d.initialScrollY=d.scrollY;d.frame=this;return this.transformData=d},width:function(){var b=this.getMargin();b=b.left+b.right;return e.prototype.width.call(this)+
b},height:function(){var b=this.getMargin();b=b.top+b.bottom;return e.prototype.height.call(this)+b}},{defaultProperties:{type:"frame"},identify:function(b){b=g.getAttributeLJ(b,"type");return null!==b&&b.toLowerCase()===c.defaultProperties.type}});k.registerType("frame",c,f.identifyPriority.normal);h.exports=c},{"./baseview.js":1,"./defaults.js":2,"./domhelpers.js":3,"./pluginmanager.js":22}],5:[function(f,h,k){f=f("../../kern/kern.js").Base.extend({constructor:function(){this.buttons=[!1,!1,!1];
this.first=this.doubleClick=this.click=this.cancel=!1;this.id=0;this.move=this.last=!1;this.shift={x:0,y:0};this.shiftKey=!1;this.start={x:0,y:0};this.startTime=(new Date).getTime();this.wheel=this.touch=!1;this.wheelDelta=0;this.position={x:0,y:0}},lifeTime:function(){return(new Date).getTime()-this.startTime},enoughDistance:function(){return 10<Math.abs(this.shift.x)+Math.abs(this.shift.y)}},{});h.exports=f},{"../../kern/kern.js":33}],6:[function(f,h,k){k=f("../../kern/kern.js");var g=f("./gesture.js");
f=f("../layerjs.js");k=k.EventManager.extend({constructor:function(){this.element=this.gesture=null;this.gesturecc=0;this.timeoutWheel=null},register:function(e,c,b){b=b||{};this._registerTouchEvents(e,c,b);this._registerWheelEvents(e,c,b)},_registerWheelEvents:function(e,c,b){var a=this;e.addEventListener("wheel",function(f){return a._wheel(f,e,c,b)})},_registerTouchEvents:function(e,c,b){var a=this,f=function(d){return a._tap(d,e,c,b)},g=function(d){return a._drag(d,e,c,b)},l=function(d){return a._release(d,
e,c,b)};"undefined"!==typeof window.ontouchstart&&(e.addEventListener("touchstart",f),e.addEventListener("touchend",l),b.dragging&&e.addEventListener("touchmove",g));b.mouseDragging&&(e.addEventListener("mousedown",f),e.addEventListener("mouseup",l),b.dragging&&e.addEventListener("mousemove",g))},_wheel:function(e,c,b,a){this.timeoutWheel&&clearTimeout(this.timeoutWheel);this.gesture=new g;this.gesture.wheel=!0;this.gesture.first=!0;this.gesture.start.x=this.gesture.position.x=this._xPosition(e);
this.gesture.start.y=this.gesture.position.y=this._yPosition(e);this.element=c;this._raiseGesture(e,b);this.gesture.first=!1;this.gesture.wheelDelta=this._wheelDelta(e);this.gesture.position={x:this.gesture.position.x+6*this.gesture.wheelDelta.x,y:this.gesture.position.y+6*this.gesture.wheelDelta.y};this.gesture.shift={x:this.gesture.position.x-this.gesture.start.x,y:this.gesture.position.y-this.gesture.start.y};this.gesture.last=!0;this._raiseGesture(e,b);return!1},_wheelDelta:function(e){var c=
{x:0,y:0};void 0!==e.deltaY&&void 0!==e.deltaX?(c.y=-e.deltaY/3,c.x=-e.deltaX/3):void 0!==e.wheelDeltaY&&void 0!==e.wheelDeltaX?(c.y=-e.wheelDeltaY/120,c.x=-e.wheelDeltaX/120):void 0!==e.detail&&(c.Y=-e.detail/3);return c},_tap:function(e,c,b,a){this.element=c;this.gesture=new g;this.gesture.first=!0;this.gesture.start.x=this._xPosition(e);this.gesture.start.y=this._yPosition(e);this.gesture.touch="mousedown"!==e.type;this.gesture.click="mousedown"===e.type;this._raiseGesture(e,b);return!1},_release:function(e,
c,b,a){this.gesture.move=!1;this.gesture.last=!0;this.gesture.position.x=this._xPosition(e);this.gesture.position.y=this._yPosition(e);this.gesture.shift.x=this.gesture.position.x-this.gesture.start.x;this.gesture.shift.y=this.gesture.position.y-this.gesture.start.y;this._raiseGesture(e,b);this.gesture=this.element=null;return!1},_drag:function(e,c,b,a){null!==this.gesture&&(this.gesture.click||this.gesture.touch)&&(this.gesture.first=!1,this.gesture.move=!0,this.gesture.position.x=this._xPosition(e),
this.gesture.position.y=this._yPosition(e),this.gesture.shift.x=this.gesture.position.x-this.gesture.start.x,this.gesture.shift.y=this.gesture.position.y-this.gesture.start.y,this._raiseGesture(e,b));return!1},_yPosition:function(e){return e.targetTouches&&1<=e.targetTouches.length?e.targetTouches[0].clientY:e.changedTouches&&1<=e.changedTouches.length?e.changedTouches[0].clientY:e.clientY},_xPosition:function(e){return e.targetTouches&&1<=e.targetTouches.length?e.targetTouches[0].clientX:e.changedTouches&&
1<=e.changedTouches.length?e.changedTouches[0].clientX:e.clientX},_raiseGesture:function(e,c){if(c&&this.gesture){this.gesture.event=e;if(!this.gesture.direction){var b=this.gesture.shift.x,a=this.gesture.shift.y;this.gesture.enoughDistance()&&(Math.abs(b)>Math.abs(a)?(this.gesture.direction=0>b?"left":"right",this.gesture.axis="x"):(this.gesture.direction=0>a?"up":"down",this.gesture.axis="y"))}c(this.gesture);this.gesture.preventDefault&&(e.preventDefault(),e.stopPropagation());this.gesture.cancelled&&
(this.gesture=this.element=null)}}});f.gestureManager2=new k;h.exports=f.gestureManager2},{"../../kern/kern.js":33,"../layerjs.js":7,"./gesture.js":5}],7:[function(f,h,k){k=f("./domhelpers.js");var g=f("./defaults.js");f("./polyfill.js");layerJS={select:k.selectView,imagePath:"/",executeScriptCode:!0,defaults:g};h.exports=layerJS},{"./defaults.js":2,"./domhelpers.js":3,"./polyfill.js":23}],8:[function(f,h,k){var g=f("./domhelpers.js"),e=f("../kern/Kern.js");k=f("./pluginmanager.js");var c=f("./layoutmanager.js"),
b=f("./scrolltransformer.js"),a=f("./gestures/gesturemanager.js"),m=f("./defaults.js"),p=f("./baseview.js"),l=p.extend({constructor:function(d){d=d||{};d.childType="frame";this.transitionQueue=new e.Queue;this.innerEl=this.outerEl=d.el;1===this.outerEl.children.length&&"scroller"===g.getAttributeLJ(this.outerEl.children[0],"helper")&&(this.innerEl=this.outerEl.children[0]);p.call(this,d);this._inTransition=!1;this.scrollID=this.transitionID=this._transitionIDcounter=1;this.currentFrame=null;this.switchLayout(this.layoutType());
this.switchScrolling(this.nativeScroll());a.register(this.outerEl,this.gestureListener.bind(this),{dragging:!0,mouseDragging:this.draggable()});var b=this;this.onResizeCallBack=function(){b.render()};this.stage=this.parent;this.on("scroll",function(){});var c;(d=this.defaultFrame())&&"!none"!==d&&((c=this._getFrame(d)||null)||console.warn("layerJS: layer '"+this.name()+"': could not find defaultframe: '"+d+"'"));c||"!none"===d||(c=this._getFrame(m.specialFrames.next)||null);this.currentFrameTransformData=
this.noFrameTransformdata();c?(this.currentFrame=c,this.showFrame(c.name(),{lastFrameName:"",applyCurrentPostPosition:!1})):(this.currentFrame=null,this.showFrame(m.specialFrames.none,{lastFrameName:""}));this.autoTrigger()},startObserving:function(){p.prototype.observe.call(this,this.innerEl,{attributes:!0,attributeFilter:"name lj-name id lj-layout-type lj-native-scroll lj-no-scrolling".split(" "),children:!0})},registerEventHandlers:function(){var a=this;p.prototype.registerEventHandlers.call(this);
this.on("attributesChanged",this.attributesChanged);if(this.parent)this.parent.on("renderRequired",function(){a.render()});this.on("transitionStarted",function(){a.autoTrigger()})},attributesChanged:function(a){(a["lj-native-scroll"]||-1!==a["data-lj-native-scroll"])&&this.switchScrolling(this.nativeScroll());-1===a["lj-layout-type"]&&-1===a["data-lj-layout-type"]||this.switchLayout(this.layoutType());-1===a["lj-timer"]&&-1===a["data-lj-timer"]||this.autoTrigger()},autoTrigger:function(){var a=this.timer();
a&&(a.match(/^[0-9]/)&&(a="#!next&d="+a),layerJS.router.navigate(a,this))},renderChildPosition:function(a){this._layout||this.switchLayout(this.layoutType());this._layout.renderFramePosition(a,this._currentTransform)},inTransition:function(a,b){b=b?50+Number.parseFloat(b):0;if(a){var d=this;this._inTransitionTimestamp=Date.now();var e=this.transitionID;this._inTransitionDuration=b;this._intransitionID=e;this._inTransition=!0;setTimeout(function(){e===d.transitionID&&(delete d._inTransitionTimestamp,
delete d._inTransitionDuration,delete d._intransitionID,d._inTransition=!1)},b)}else!1===a&&this.transitionID===this._intransitionID&&(delete this._inTransitionTimestamp,delete this._inTransitionDuration,delete this._intransitionID,this._inTransition=!1);return this._inTransition},getRemainingTransitionTime:function(){return this._inTransition?Math.max(1,this._inTransitionDuration-(Date.now()-this._inTransitionTimestamp)-50):!1},switchScrolling:function(a){this.unobserve();var d=1===this.outerEl.children.length&&
"scroller"===g.getAttributeLJ(this.outerEl.children[0],"helper");a?(this.innerEl=d?this.outerEl.children[0]:g.wrapChildren(this.outerEl),g.setAttributeLJ(this.innerEl,"helper","scroller"),this.innerEl._ljView||(this.innerEl._ljView=this.outerEl._ljView,this.innerEl._state=this.outerEl._state),g.addClass(this.outerEl,"nativescroll")):(d&&g.unwrapChildren(this.outerEl),this.innerEl=this.outerEl,g.removeClass(this.outerEl,"nativescroll"));this._transformer=this._layout.getScrollTransformer()||new b(this);
this.setNativeScroll(a);this.currentFrame&&this.showFrame(this.currentFrame.name(),this.currentFrame.getScrollData());this.startObserving()},getCurrentScroll:function(){return{scrollX:this.currentFrameTransformData.scrollX,scrollY:this.currentFrameTransformData.scrollY}},scrollTo:function(a,b,c){if(null!==this.currentFrame){c=c||{};c.startPosition&&(this.currentFrameTransformData=this.currentFrame.getTransformData(this,c.startPosition));var d=this.currentFrameTransformData;"object"===typeof a&&(c=
a,a=0);a=void 0!==a?a:void 0!==c.scrollX?c.scrollX:d.scrollX||0;b=void 0!==b?b:void 0!==c.scrollY?c.scrollY:d.scrollY||0;c.scrollX=a;c.scrollY=b;c=e._extend({lastFrameName:this.currentFrame.name(),applyTargetPrePosition:!1,applyCurrentPostPosition:!1,applyCurrentPrePosition:!1,duration:"",type:"none"},c||{});return this.transitionTo(this.currentFrame.name(),c)}},switchLayout:function(a){this._layout=new (c.get(a))(this);this._transformer=this._layout.getScrollTransformer()||new b(this);this.currentFrame&&
this.render()},setLayerTransform:function(a,b){var d=0;b&&b.transition&&(d=g.timeToMS(b.transition));d=this.inTransition()?Math.max(this.getRemainingTransitionTime(),d):d;return this._layout.setLayerTransform(a,{transition:d?d+"ms":""})},gestureListener:function(a){if(!a.event._ljEvtHndld||a.event._ljEvtHndld===this)if(a.event._ljEvtHndld=this,null!==this.currentFrame){var b=this._transformer.scrollGestureListener(a);a.first||("wheel"===a.event.type&&(a.preventDefault=!0),!0===b?a.preventDefault=
!1:b?(this.setLayerTransform(this.currentTransform=b),a.preventDefault=!0):(this.inTransition()&&(a.preventDefault=!0),b=this.currentFrame.neighbors(),a.direction?b&&b[m.directions2neighbors[a.direction]]?(a.preventDefault=!0,!this.inTransition()&&(a.last||a.wheel&&a.enoughDistance())&&this.transitionTo(b[m.directions2neighbors[a.direction]],{type:m.neighbors2transition[m.directions2neighbors[a.direction]]})):(a.preventDefault=!1,g.debug(a.direction),!b||!b.l&&!b.r||"left"!==a.direction&&"right"!==
a.direction||(a.preventDefault=!0)):(a.event.stopPropagation(),a.preventDefault=!0)))}},showFrame:function(a,b){if(this.stage)return b=e._extend({scrollX:0,scrollY:0,lastFrameName:this.currentFrame&&this.currentFrame.name()||"!none",applyTargetPrePosition:!1,applyCurrentPostPosition:this.currentFrame?a!==this.currentFrame.name()&&a!==m.specialFrames.current:!1,applyCurrentPrePosition:!1,duration:"",type:"none"},b||{}),this.transitionTo(a,b)},noFrameTransformdata:function(a){if(this._noframetd&&this._noframetd.startPosition===
a)return this._noframetd;var b=this._noframetd={};b.stage=this.stage;b.scale=1;b.width=this.stage?this.stage.width():0;b.height=this.stage?this.stage.height():0;b.frameWidth=0;b.frameHeight=0;var d=this.fitTo();switch(d){case "width":case "elastic-width":case "responsive-width":b.frameWidth=b.width;break;case "height":case "elastic-height":case "responsive-height":b.frameHeight=b.height;break;case "fixed":case "responsive":case "contain":case "cover":b.frameWidth=b.width;b.frameHeight=b.height;break;
default:throw"unkown fitTo type '"+d+"'";}this.stage&&this.stage.autoHeight()&&(b.height=b.frameHeight=0);this.stage&&this.stage.autoWidth()&&(b.width=b.frameWidth=0);b.shiftX=b.shiftY=b.scrollX=b.scrollY=0;b.isScrollX=b.isScrollY=!1;b.startPosition=a||"top";b.initialScrollX=b.scrollX;b.initialScrollY=b.scrollY;return b},transitionTo:function(a,b){var d=this;b=b||{};"object"===typeof a&&null!==a?(b=a,a=b.framename):null!==a&&(a=a||b&&b.framename);var c=b.groupId||(b.groupId=g.uniqueID("group")),f=
this.lastgroupId!==c;this.lastgroupId=c;if(b.delay)b.semaphore&&b.semaphore.skip(),setTimeout(function(){b.groupId===d.lastgroupId&&(delete b.semaphore,delete b.delay,delete b.transitionID,d.transitionTo(a,b))},g.timeToMS(b.delay));else{var l=function(){if(!a&&null!==a)throw"transformTo: no frame given";var c=a?d._getFrame(a,b):null;if(!c&&null!==c)throw"transformTo: "+a+" does not exist in layer";c&&null!==c&&(a=c.name());if(b&&b.type&&b.type.match(/^auto:/)){var f=b.type.replace(/^auto:/,"");delete b.type}b=
e._extend({type:b&&b.type?"default":c&&c.defaultTransition()||d.defaultTransition()||f||"default",previousType:b&&b.type?void 0:d.currentFrame&&d.currentFrame.defaultTransition()||void 0,duration:m.defaultDuration,lastFrameName:d.currentFrame&&d.currentFrame.name()||"!none",applyTargetPrePosition:!b.noActivation&&(b.applyTargetPrePosition||c&&c.parent&&c.parent===d)||!1,interStage:c&&c.parent&&c.parent!==d,applyCurrentPostPosition:!0!==b.applyCurrentPostPosition&&d.currentFrame&&d.currentFrame.parent&&
d.currentFrame.parent===d&&!b.noActivation||!1,applyCurrentPrePosition:!0!==b.applyCurrentPrePosition&&d.currentFrame&&d.currentFrame.parent&&d.currentFrame.parent===d&&!b.noActivation||!1},b||{});b.type&&b.type.match(/^(?:r:|reverse:)/i)&&(b.type=b.type.replace(/^(?:r:|reverse:)/i,""),b.reverse=!0);b.previousType&&b.previousType.match(/^(?:r:|reverse:)/i)&&(b.previousType=b.previousType.replace(/^(?:r:|reverse:)/i,""),b.previousReverse=!0);b.semaphore||(b.semaphore=(new e.Semaphore).register());
b.semaphore.listen(!0).then(function(a){0<a&&(!1!==b.applyTargetPrePosition||b.interStage)&&d.trigger("transitionPrepared")});b.semaphore.listen().then(function(){d.updateClasses();d.transitionQueue.continue()});d.inTransition()&&(b.wasInTransition=!0);b.duration=Math.max(d.getRemainingTransitionTime()||0,g.timeToMS(b.duration)||0)+"ms";"0ms"===b.duration&&(b.duration="");d.trigger("beforeTransition",a);b.transitionID=d.transitionID=++d._transitionIDcounter;d.inTransition(!0,g.timeToMS(b.duration));
g.debug("running new transition",b.transitionID,b,a,d.id());return d._layout.loadFrame(c).then(function(){var f=d.getCurrentScroll(),m=null===c?d.noFrameTransformdata(b.startPosition):c.getTransformData(d,b.startPosition),l=d._transformer.getScrollTransform(m,b,!0);if(d.currentFrame===c&&d.currentFrameTransformData===m)if(m.scrollX!==f.scrollX||m.scrollY!==f.scrollY)b=e._extend(b,{applyTargetPrePosition:!1,applyCurrentPostPosition:!1,applyCurrentPrePosition:!1,scrollX:m.scrollX,scrollY:m.scrollY,
type:"none"});else{var n=new e.Promise;d.trigger("transitionStarted",a,b);b.semaphore.sync().then(function(){b.wasInTransition||(d.trigger("transitionFinished",a),d.inTransition(!1));n.resolve()});return n}c&&(c.inTransition=!0);f=d._layout.transitionTo(c,b,m,l).then(function(){b.transitionID===d.transitionID&&(g.debug("transition finished",b.transitionID),b.noActivation||(d.currentTransform=d._transformer.getScrollTransform(m,b,!1)),d.inTransition(!1),b.noActivation||d.setLayerTransform(d.currentTransform),
d.updateClasses(),c&&(c.inTransition=!1),g.postAnimationFrame(function(){d.trigger("transitionFinished",a)}))});b.noActivation||(d.currentFrameTransformData=m,d.currentFrame=c,d.currentTransform=l);d.trigger("transitionStarted",a,b);return f})};return f?this.transitionQueue.add(b.isEvent&&"event").then(function(){try{return l()}catch(r){throw d.transitionQueue.continue(),r;}}):l()}},_getFrame:function(a,b){if(a===m.specialFrames.left||a===m.specialFrames.right||a===m.specialFrames.top||a===m.specialFrames.bottom)if(null!==
this.currentFrame){var d=this.currentFrame.neighbors();b=b||{};d&&d.l&&a===m.specialFrames.left?a=d.l:d&&d.r&&a===m.specialFrames.right?a=d.r:d&&d.t&&a===m.specialFrames.top?a=d.t:d&&d.b&&a===m.specialFrames.bottom?a=d.b:b.type!==m.neighbors2transition.r||a!==m.specialFrames.left||(!d||d.l)&&d?b.type!==m.neighbors2transition.l||a!==m.specialFrames.right||(!d||d.r)&&d?b.type!==m.neighbors2transition.b||a!==m.specialFrames.bottom||(!d||d.u)&&d?b.type!==m.neighbors2transition.u||a!==m.specialFrames.top||
(!d||d.b)&&d?d||(a=m.specialFrames.next):a=m.specialFrames.next:a=m.specialFrames.previous:a=m.specialFrames.previous:a=m.specialFrames.next}else null===this.currentFrame&&(a!==m.specialFrames.previous?a=m.specialFrames.next:a!==m.specialFrames.next&&(a=m.specialFrames.previous));a===m.specialFrames.next?a=this._getNextFrameName():a===m.specialFrames.previous?a=this._getPreviousFrameName():a===m.specialFrames.current&&(a=null!==this.currentFrame?this.currentFrame.name():m.specialFrames.none);if(a===
m.specialFrames.none)b=null;else if(b=this.getChildViewByName(a),void 0===b&&void 0!==a){a=layerJS.getState().resolvePath(a);if(1<a.length)throw"only 1 path should be expected";0<a.length&&(b=a[0].view)}return b},_getNextFrameName:function(){var a=this.getChildViews();if(null===this.currentFrame&&0<a.length)var b=a[0].name();else if(null!==this.currentFrame&&0<a.length){for(b=0;b<a.length&&this.currentFrame.name()!==a[b].name();b++);b=b+1<a.length?a[b+1].name():a[0].name()}return b},_getPreviousFrameName:function(){var a=
this.getChildViews();if(null===this.currentFrame&&0<a.length)var b=a[0].name();else if(null!==this.currentFrame&&0<a.length){for(var c=a.length-1;0<=c&&this.currentFrame.name()!==a[c].name();c--);0===c?b=a[a.length-1].name():0<c&&(b=a[c-1].name())}return b},getCurrentTransform:function(){return this.currentTransform},updateClasses:function(){for(var a=this.getChildViews(),b=a.length,c=0;c<b;c++)g.removeClass(a[c].outerEl,"lj-active"),g.removeClass(a[c].outerEl,"lj-transition");null!==this.currentFrame&&
g.addClass(this.currentFrame.outerEl,"lj-active");for(c=0;c<arguments.length;c++)arguments[c]&&arguments[c].outerEl&&g.addClass(arguments[c].outerEl,"lj-transition")},_renderChildPosition:function(a){this._layout||this.switchLayout(this.layoutType());a.unobserve();this._layout.renderFramePosition(a,this.currentTransform);a.startObserving()},render:function(){var a=this.getChildViews(),b=a.length,c=null!==this.currentFrame?this.currentFrame.getScrollData():{};c.isEvent=!0;for(var e=0;e<b;e++){var f=
a[e];void 0!==f.transformData&&(f.transformData.isDirty=!0)}this.showFrame(m.specialFrames.current,c)},_parseChildren:function(a){p.prototype._parseChildren.call(this,a);var b=this._cache.children,d=this;a&&a.removedNodes&&0<a.removedNodes.length&&a.removedNodes.forEach(function(a){a._ljView&&a._ljView.off("renderRequired",void 0,d)});if(a&&a.addedNodes&&0<a.addedNodes.length){b=[];for(var c=0;c<a.addedNodes.length;c++)a.addedNodes[c]._ljView&&b.push(a.addedNodes[c]._ljView)}a=function(a){d.currentFrame&&
null!==d.currentFrame&&d.currentFrame.name()===a&&(d._renderChildPosition(d._cache.childNames[a]),d.render())};for(c=0;c<b.length;c++)b[c].on("renderRequired",a,{context:this})}},{defaultProperties:{type:"layer"},identify:function(a){a=g.getAttributeLJ(a,"type");return null!==a&&a.toLowerCase()===l.defaultProperties.type}});k.registerType("layer",l,m.identifyPriority.normal);h.exports=l},{"../kern/Kern.js":32,"./baseview.js":1,"./defaults.js":2,"./domhelpers.js":3,"./gestures/gesturemanager.js":6,
"./layoutmanager.js":9,"./pluginmanager.js":22,"./scrolltransformer.js":28}],9:[function(f,h,k){k=f("./layerjs.js");var g=f("../kern/Kern.js");f=g.EventManager.extend({constructor:function(e){g.EventManager.call(this);this.map=e||{}},registerType:function(e,c){this.map[e]=c},get:function(e){return this.map[e]}});k.layoutManager=new f;h.exports=k.layoutManager},{"../kern/Kern.js":32,"./layerjs.js":7}],10:[function(f,h,k){var g=f("../domhelpers.js"),e=f("../../kern/Kern.js");k=f("../layoutmanager.js");
var c=f("./layerlayout.js");f=c.extend({constructor:function(b){c.call(this,b);this._frameTransforms={}},transitionTo:function(b,a,c,f){var m=new e.Promise,d=this,g=this.layer.getChildViews(),p=g.length,k,h=a.noActivation?b:g[p-1],z=function(){if(a.transitionID===d.layer.transitionID)for(var c=0;c<(a.noActivation?p:1);c++)k=a.noActivation?b:g[c],k.applyStyles({transition:"none"});m.resolve()};""!==a.duration&&h.outerEl.addEventListener("transitionend",function t(a){h.outerEl===a.target&&(a.target.removeEventListener(a.type,
t),z())});a.semaphore.sync().then(function(){if(null!==b){var e=function(b){var c=b.getTransformData(d.layer),e={transition:a.duration,opacity:1,display:"block"};e.width=c.applyWidth?c.frameWidth+"px":b.getOriginalWidth();e.height=c.applyHeight?c.frameHeight+"px":b.getOriginalHeight();d._applyTransform(b,d._reverseTransform,f,e)};if(a.noActivation)e(b);else{d._reverseTransform=d._calculateReverseTransform(b,c);for(var m=0;m<p;m++)e(g[m])}}else for(e=0;e<p;e++)k=g[e],k.applyStyles({opacity:0,transition:a.duration});
""===a.duration&&z()});return m},_calculateReverseTransform:function(b,a){var c=parseInt(b.x(),10)||0,e=parseInt(b.y(),10)||0,f=b.rotation()||0;this._currentRotation&&(f>this._currentRotation+180&&(f-=360*(1+Math.floor((f-this._currentRotation)/360))),f<this._currentRotation-180&&(f+=360*(1+Math.floor((this._currentRotation-f)/360))));this._currentRotation=f;return"translate3d("+parseInt(-a.shiftX,10)+"px,"+parseInt(-a.shiftY,10)+"px,0px) scale("+a.scale/(b.scaleX()||1)+","+a.scale/(b.scaleY()||1)+
") rotate("+(-f||0)+"deg)  translate3d("+-c+"px,"+-e+"px,0px)"},setLayerTransform:function(b,a){var c=this.layer.getChildViews(),f=c.length,l=new e.Promise;a.transition?this.layer.currentFrame.outerEl.addEventListener("transitionend",function v(a){a.target.removeEventListener(a.type,v);l.resolve()}):l.resolve();for(var d=0;d<f;d++){var g=c[d];this._applyTransform(g,this._reverseTransform,b,a)}return l},renderFramePosition:function(b,a){c.prototype.renderFramePosition.call(this,b,a);delete this._frameTransforms[b.id()];
this._reverseTransform&&a&&this._applyTransform(b,this._reverseTransform,this.layer.currentTransform,{})},_applyTransform:function(b,a,c,e){e=e||{};var f=b.x(),d=b.y();void 0!==f&&(e.left=g.parseDimension(f)+"px");void 0!==d&&(e.top=g.parseDimension(d)+"px");b.applyStyles(e||{},{transform:"translate3d("+(-b.x()||0)+"px,"+(-b.y()||0)+"px,0px)"+c+" "+a+" "+(this._frameTransforms[b.id()]="translate3d("+(b.x()||0)+"px,"+(b.y()||0)+"px,0px) rotate("+(b.rotation()||0)+"deg) scale("+b.scaleX()+","+b.scaleY()+
")")})}});k.registerType("canvas",f);h.exports=f},{"../../kern/Kern.js":32,"../domhelpers.js":3,"../layoutmanager.js":9,"./layerlayout.js":11}],11:[function(f,h,k){var g=f("../domhelpers.js"),e=f("../../kern/Kern.js"),c=f("../tmat.js");f=e.EventManager.extend({constructor:function(b){e.EventManager.call(this);if(!b)throw"provide a layer";this.layer=b},renderFramePosition:function(b){b.x();b.y();b.width();b.height()},loadFrame:function(b){var a=new e.Promise,f=null!==b&&b.document.defaultView&&b.document.defaultView.getComputedStyle||
function(a){return a.style};if(null===b||b.document.body.contains(b.outerEl)&&"none"!==f(b.outerEl).display&&b.parent===this.layer)a.resolve();else{if(b.parent!==this.layer){f=this.layer.outerEl;var p=g.commonParent(b.innerEl,f),l=function(a,b){var d=new c;a!==b&&(d=l(a.parentNode,b));a=g.getScaleAndRotationMatrix(a);return d.prod(a)},d=l(b.outerEl,p);d=g.applyTopLeftOnMatrix(b.outerEl,d);p=l(f,p);p=g.applyTopLeftOnMatrix(f,p);f=p.invert().prod(d);b.parent.currentFrame===b&&(b.parent.currentFrame=
null);this.layer.innerEl.appendChild(b.outerEl);b.transformData=void 0;b.applyStyles({transform:f.transform_nomatrix(),top:"0px",left:"0px"});g.debug("moved "+b.id()+" to layer "+this.layer.id())}else b.outerEl.style.display="block",b.outerEl.style.opacity="0";g.postAnimationFrame(function(){a.resolve()})}return a},getStageWidth:function(){return this.layer.stage.width()},getStageHeight:function(){return this.layer.stage.height()},transitionTo:function(){throw"transitionTo() not implemented";},prepareTransition:function(){},
parametricTransition:function(){throw"parametricTransition() not implemented";},getScrollTransformer:function(){}});h.exports=f},{"../../kern/Kern.js":32,"../domhelpers.js":3,"../tmat.js":31}],12:[function(f,h,k){var g=f("../domhelpers.js"),e=f("../../kern/Kern.js");k=f("../layoutmanager.js");var c=f("./layerlayout.js"),b=["adjacent",0,0,1,0];f=["adjacent",-1,0,1,0];var a=["adjacent",1,0,1,0],m=["adjacent",0,1,1,0],p=["adjacent",0,-1,1,0],l=["adjacent",0,0,1,0,{opacity:0}],d=["adjacent",0,0,1,0,{filter:"blur(5px)",
opacity:0},{filter:"blur(0px)"}],n=["adjacent",0,0,.666,0,{opacity:0}],q=["adjacent",0,0,1.5,0,{opacity:0}],A={default:[a,f,1],none:[b,b,1],left:[a,f,1],right:[f,a,1],up:[m,p,1],down:[p,m,1],fade:[l,l,-1],blur:[d,d,-1],slideOverLeft:[a,b,1],slideOverRight:[f,b,1],slideOverUp:[m,b,1],slideOverDown:[p,b,1],slideOverLeftFade:[a,l,1],slideOverRightFade:[f,l,1],slideOverUpFade:[m,l,1],slideOverDownFade:[p,l,1],zoomout:[q,n,1],zoomin:[n,q,-1]};f=c.extend({constructor:function(a){c.call(this,a);this._preparedTransitions=
{}},hideOtherFrames:function(a,b){for(var d=this.layer.getChildViews(),c=0;c<d.length;c++)d[c]!==b&&d[c]!==a&&null!==d[c].outerEl.parentNode&&d[c].applyStyles({display:"none"})},transitionTo:function(a,b,d,c){var f=this,m=f.layer.currentFrame;return this.prepareTransition(a,b,d,c).then(function(l){var p=new e.Promise,n=0,q=function(a,d){a.transitionID&&b.transitionID!==a.transitionID||(a.applyStyles(l.fix_css,d?{transition:"none",display:"none","z-index":"initial"}:{transition:"none","z-index":"initial"}),
g.debug("slidelayout: fix "+(d?"c":"t")));n--;0===n&&p.resolve()};b.semaphore.sync().then(function(){var e={transition:b.duration,top:"0px",left:"0px",opacity:"1"};d.applyWidth&&(e.width=d.frameWidth+"px");d.applyHeight&&(e.height=d.frameHeight+"px");a&&(a.transitionID=b.transitionID);a&&""!==b.duration&&(a.outerEl.addEventListener("transitionend",function B(d){d.target===a.outerEl&&(d.target.removeEventListener(d.type,B),q(a,!!b.noActivation))}),n++);b.noActivation?f._applyTransform(a,{opacity:0,
transition:b.duration},{},{}):f._applyTransform(a,f._currentFrameTransform=l.t1,c,e);g.debug("slidelayout: apply t1");!1!==b.applyCurrentPostPosition&&(m&&(m.transitionID=b.transitionID),m&&""!==b.duration&&(m.outerEl.addEventListener("transitionend",function B(a){a.target===m.outerEl&&(a.target.removeEventListener(a.type,B),q(m,!0))}),n++),f._applyTransform(m,l.c1,c,{transition:b.duration,top:"0px",left:"0px"}),g.debug("slidelayout: apply c1"));""===b.duration&&(n=m&&m!==a&&a?2:1,m&&m!==a&&q(m,!0),
a&&q(a));f._preparedTransitions={}});return p})},prepareTransition:function(a,d,c,f){var m=new e.Promise,l,p=this.layer.currentFrame;d.wasInTransition||this.hideOtherFrames(a,p);a&&(l=this._preparedTransitions[a.id()])&&(l.transform===f&&l.applied?m.resolve(l):l=void 0);if(!l){var n=A[d.type];!n&&d.type&&d.type.match(/:/)?n=d.type.split(":"):n||(n=[b,b,1]);if("function"===typeof n)l=n(d.type,this.layer.currentFrameTransformData,c);else if(Array.isArray(n)){n=d.reverse?[n[1],n[0],this.layer.currentFrameTransformData,
c,n[2]&&-n[2]||0]:[n[0],n[1],this.layer.currentFrameTransformData,c,n[2]];if(d.previousType){var q=A[d.previousType];Array.isArray(q)&&(n[1]=d.previousReverse?q[1]:q[0])}l=this.genericTransition.apply(this,n)}else throw"slidelayout: error in registered transition type.";l.transform=f;if(!1===d.applyTargetPrePosition&&!1===d.applyCurrentPrePosition)return m.resolve(l),m;if(null===a&&!l.current_css)return l.applied=!0,m.resolve(l),m;f={transition:"none",visibility:"inital"};c.applyWidth&&(f.width=c.frameWidth+
"px");c.applyHeight&&(f.height=c.frameHeight+"px");!1!==d.applyTargetPrePosition&&(this._applyTransform(a,l.t0,this.layer.currentTransform,f),g.debug("slidelayout: apply t0"));p&&l.current_css&&!1!==d.applyCurrentPrePosition&&(this._applyTransform(p,l.c0,this.layer.currentTransform,{transition:"none","z-index":"initial"}),g.debug("slidelayout: apply c0"));g.postAnimationFrame(function(){l.applied=!0;m.resolve(l)})}return m},setLayerTransform:function(a,b){b=b||{};var d=new e.Promise;b.transition?
this.layer.currentFrame.outerEl.addEventListener("transitionend",function u(a){a.target.removeEventListener(a.type,u);d.resolve()}):d.resolve();this._applyTransform(this.layer.currentFrame,this._currentFrameTransform,a,b);return d},_applyTransform:function(a,b,d,c){a&&(b=e._extend({},b),b.transform=d+" "+(b.transform||""),a.applyStyles({left:"0px",top:"0px"},c||{},b))},_calcFrameTransform:function(a){return{transform:"translate3d("+-a.shiftX+"px,"+-a.shiftY+"px,0px) scale("+a.scale+")",opacity:1}},
genericTransition:function(a,b,d,c,f){var m=this,l=function(a,b,d,c){var f=m.getStageWidth(),l=m.getStageHeight(),g=-b.shiftX,n=-b.shiftY,p=-d.shiftX,q=-d.shiftY,k=a[1],h=a[2],A=a[3],v=a[4],y=a[5]||{};switch(a[0]){case "adjacent":return p=0>k?p+(Math.min(g,0)-d.width-p)*Math.abs(k):p+(Math.max(g+b.width,f)-p)*Math.abs(k),q=0>h?q+(Math.min(n,0)-d.height-q)*Math.abs(h):q+(Math.max(n+b.height,l)-q)*Math.abs(h),0===k&&(p+=-d.scrollX*d.scale+b.scrollX*b.scale),0===h&&(q+=-d.scrollY*d.scale+b.scrollY*b.scale),
e._extend({transform:"translate3d("+p+"px,"+q+"px,"+c+"px) scale("+d.scale*A+") rotate("+v+"deg)",opacity:1,"z-index":c},y)}},g=a[6]||{},n=b[6]||{};g={t1:e._extend(this._calcFrameTransform(c),g),c0:e._extend(this._calcFrameTransform(d),n)};Object.keys(n).length&&(g.current_css=!0);g.t0=l(a,d,c,f||0);g.c1=l(b,c,d,f&&-f||0);g.fix_css=[a[5],b[5],a[6],b[6]].map(function(a){return Object.keys(a||{})}).reduce(function(a,b){"transform"!==b&&""!==b&&(a[b]="initial");return a},{});return g}});k.registerType("slide",
f);h.exports=f},{"../../kern/Kern.js":32,"../domhelpers.js":3,"../layoutmanager.js":9,"./layerlayout.js":11}],13:[function(f,h,k){var g=f("./observer.js");f=g.extend({constructor:function(e,c){this.attributes={};g.call(this,e,c)},_initalizeAttributes:function(){this.attributes={};for(var e=this.element.attributes.length,c=0;c<e;c++){var b=this.element.attributes[c];this.attributes[b.name]=b.value}},_invokeCallBack:function(e){if(this.options.attributeFilter&&e.attributes&&0<Object.getOwnPropertyNames(e.attributes).length){var c=
{},b;for(b in e.attributes)if(e.attributes.hasOwnProperty(b))for(var a=b.toUpperCase(),f=0;f<this.options.attributeFilter.length;f++){var g=this.options.attributeFilter[f].toUpperCase(),l=g===a||g.endsWith("*")&&a.startsWith(g.slice(0,-1));!l&&g.startsWith("LJ-")&&(g="DATA-"+g,l=g===a||g.endsWith("*")&&a.startsWith(g.slice(0,-1)));l&&(c[b]=e.attributes[b])}e.attributes=c}this.options.callback&&(e.attributes&&0<Object.getOwnPropertyNames(e.attributes).length||e.addedNodes&&0<e.addedNodes.length||e.removedNodes&&
0<e.removedNodes.length||e.characterData)&&this.options.callback(e)}});h.exports=f},{"./observer.js":17}],14:[function(f,h,k){var g=f("../../kern/Kern.js"),e=f("./observerfactory.js");f=g.EventManager.extend({constructor:function(){g.EventManager.call(this)},_domElementChanged:function(c){0<Object.getOwnPropertyNames(c.attributes).length&&this.trigger("attributesChanged",c.attributes);(0<c.removedNodes.length||0<c.addedNodes.length)&&this.trigger("childrenChanged",{addedNodes:c.addedNodes,removedNodes:c.removedNodes})},
observe:function(c,b){this.unobserve();var a=this;if(b.attributes||b.children)this._observer=e.getObserver(c,{attributes:b.attributes,attributeFilter:b.attributeFilter,childList:b.children||!1,timeout:b.timeout,callback:function(b){a._domElementChanged(b)}}),this._observer.observe();b.size&&(this._sizeObserver=e.getSizeObserver(c,{timeout:b.timeout,callback:function(){a.trigger("sizeChanged")}}),this._sizeObserver.observe())},unobserve:function(){this._observer&&this._observer.stop();this._sizeObserver&&
this._sizeObserver.stop()},isObserving:function(){return void 0!==this._observer&&this._observer.isObserving()||void 0!==this._sizeObserver&&this._sizeObserver.isObserving()}});h.exports=f},{"../../kern/Kern.js":32,"./observerfactory.js":18}],15:[function(f,h,k){arguments[4][13][0].apply(k,arguments)},{"./observer.js":17,dup:13}],16:[function(f,h,k){var g=f("./ElementObserver.js");f=g.extend({constructor:function(e,c){g.call(this,e,c);var b=this;this.mutationObserver=new (e.ownerDocument.defaultView||
e.ownerDocument.parentWindow).MutationObserver(function(a){b.mutationCallback(a)})},mutationCallback:function(e){for(var c={attributes:[],addedNodes:[],removedNodes:[]},b=0;b<e.length;b++){var a=e[b];this.options.attributes&&"attributes"===a.type&&(c.attributes[a.attributeName]={oldValue:this.attributes[a.attributeName],newValue:this.element.getAttribute(a.attributeName)},this.attributes[a.attributeName]=c.attributes[a.attributeName].newValue);if(this.options.childList&&"childList"===a.type){if(a.addedNodes&&
0<a.addedNodes.length)for(var f=0;f<a.addedNodes.length;f++)c.addedNodes.push(a.addedNodes[f]);if(a.removedNodes&&0<a.removedNodes.length)for(f=0;f<a.removedNodes.length;f++)c.removedNodes.push(a.removedNodes[f])}}this._invokeCallBack(c)},observe:function(){0!==this.counter&&this.counter--;0===this.counter&&(1===this.element.nodeType&&this.options.attributes&&this._initalizeAttributes(),this.mutationObserver.observe(this.element,{attributes:this.options.attributes||!1,childList:this.options.childList||
!1,characterData:this.options.characterData||!1}))},stop:function(){0===this.counter&&this.mutationObserver.disconnect();this.counter++}});h.exports=f},{"./ElementObserver.js":13}],17:[function(f,h,k){f=f("../../kern/kern.js").Base.extend({constructor:function(f,e){e=e||{};this.element=f;this.options=e;this.counter=1},observe:function(){throw"not implemented";},stop:function(){throw"not implemented";},isObserving:function(){return 0===this.counter},_invokeCallBack:function(){this.options&&this.options.callback&&
this.options.callback()}});h.exports=f},{"../../kern/kern.js":33}],18:[function(f,h,k){k=f("../../kern/kern.js");var g=f("./mutationsobserver.js"),e=f("./timeoutobserver.js"),c=f("./sizeobserver.js");f=k.Base.extend({constructor:function(){},getObserver:function(b,a){var c=b.ownerDocument.defaultView||b.ownerDocument.parentWindow;return c&&c.MutationObserver?new g(b,a):new e(b,a)},getSizeObserver:function(b,a){return new c(b,a)}});h.exports=new f},{"../../kern/kern.js":33,"./mutationsobserver.js":16,
"./sizeobserver.js":19,"./timeoutobserver.js":20}],19:[function(f,h,k){var g=f("./observer.js");f=g.extend({constructor:function(e,c){g.call(this,e,c);this.dimensions=void 0},observe:function(){0!==this.counter&&this.counter--;0===this.counter&&(this.dimensions={size_inner:{width:this.element.scrollWidth,height:this.element.scrollHeight},size:{width:this.element.clientWidth,height:this.element.clientHeight}},this.checkSize())},stop:function(){this.counter++;1===this.counter&&(clearTimeout(this.myTimeout),
this.myTimeout=void 0)},checkSize:function(){var e=this.element,c=e.scrollWidth,b=e.scrollHeight,a=e.clientWidth;e=e.clientHeight;if(a!==this.dimensions.size.width||e!==this.dimensions.size.height||c!==this.dimensions.size_inner.width||b!==this.dimensions.size_inner.height)this.dimensions.size={width:a,height:e},this.dimensions.size_inner={width:c,height:b},this._invokeCallBack();var f=this;this.myTimeout=setTimeout(function(){f.checkSize()},this.options.timeout||100)}});h.exports=f},{"./observer.js":17}],
20:[function(f,h,k){var g=f("./elementobserver.js");f=g.extend({constructor:function(e,c){g.call(this,e,c);this.childNodes=[];this.myTimeout=this.characterData=void 0},elementModified:function(){var e={attributes:{},addedNodes:[],removedNodes:[],characterData:!1};if(this.options.attributes&&1===this.element.nodeType){var c,b={};for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(b[c]=!1);for(var a=0;a<this.element.attributes.length;a++){var f=this.element.attributes[a];this.attributes.hasOwnProperty(f.name)?
this.attributes[f.name]!==f.value&&(e.attributes[f.name]={oldValue:this.attributes[f.name],newValue:f.value},this.attributes[f.name]=f.value):(e.attributes[f.name]={oldValue:void 0,newValue:f.value},this.attributes[f.name]=f.value);b[f.name]=!0}for(c in b)b.hasOwnProperty(c)&&!b[c]&&(e.attributes[c]={oldValue:this.attributes[c],newValue:void 0},delete this.attributes[c])}if(this.options.childList&&1===this.element.nodeType){for(c=0;c<this.childNodes.length;c++)b=this.childNodes[c],this.element.contains(b)||
(this.childNodes.splice(c,1),e.removedNodes.push(b));for(c=0;c<this.element.childNodes.length;c++)b=this.element.childNodes[c],-1===this.childNodes.indexOf(b)&&(e.addedNodes.push(b),this.childNodes.push(b))}this.options.characterData&&3===this.element.nodeType&&this.characterData!==this.element.data&&(e.characterData=!0,this.characterData=this.element.data);this._invokeCallBack(e);this.observe()},observe:function(){0!==this.counter&&this.counter--;if(0===this.counter){1===this.element.nodeType&&this.options.attributes&&
this._initalizeAttributes();3===this.element.nodeType&&(this.characterData=this.element.data);this.childNodes=[];this.myTimeout=void 0;for(var e=this.element.childNodes.length,c=0;c<e;c++)this.childNodes.push(this.element.childNodes[c]);var b=this;this.myTimeout=setTimeout(function(){b.elementModified()},this.options.timeout||25)}},stop:function(){this.counter++;void 0!==this.myTimeout&&(clearTimeout(this.myTimeout),this.myTimeout=void 0)}});h.exports=f},{"./elementobserver.js":15}],21:[function(f,
h,k){var g=f("./pluginmanager.js"),e=f("./domhelpers.js"),c=f("../kern/Kern.js");layerJS.parseManager=new function(){this.parseDocument=function(b){b=b||document;this._parse(b,b)};this.parseElement=function(b,a){1===b.nodeType&&this._parse(b,b.ownerDocument,a)};this._parse=function(b,a,f){b=b.querySelectorAll("[data-lj-type='stage'],[lj-type='stage']");var m=b.length;f=f||{};for(var l=layerJS.getState(a),d=0;d<m;d++){var n=g.createView(e.getAttributeLJ(b[d],"type"),c._extend(f,{el:b[d],document:a}));
l.registerView(n)}}};h.exports=layerJS.parseManager},{"../kern/Kern.js":32,"./domhelpers.js":3,"./pluginmanager.js":22}],22:[function(f,h,k){k=f("./layerjs.js");var g=f("../kern/Kern.js");f=g.EventManager.extend({constructor:function(e,c){g.EventManager.call(this);this.map=e||{};this.identifyPriorities=c||{}},createView:function(e,c){if(c&&c.el&&c.el._ljView)return c.el._ljView;if("string"===typeof e&&this.map.hasOwnProperty(e))return new this.map[e].view(c);throw"no constructor found for objects of type '"+
e+"'";},registerType:function(e,c,b){this.map[e]={view:c,identify:c.identify};void 0===this.identifyPriorities[b]&&(this.identifyPriorities[b]=[]);this.identifyPriorities[b].push(c)},identify:function(e){for(var c,b=Object.keys(this.identifyPriorities).sort(function(a,b){return-1*(a-b)}),a=0;a<b.length;a++){for(var f=b[a],g=0;g<this.identifyPriorities[f].length;g++)if(this.identifyPriorities[f][g].identify(e)){c=this.identifyPriorities[f][g].defaultProperties.type;break}if(void 0!==c)break}if(void 0===
c)throw"no ViewType found for element '"+e+"'";return c}});k.pluginManager=new f({});h.exports=k.pluginManager},{"../kern/Kern.js":32,"./layerjs.js":7}],23:[function(f,h,k){String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(f,e){var c=this.toString();if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e>c.length)e=c.length;e-=f.length;f=c.lastIndexOf(f,e);return-1!==f&&f===e}});String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",
{value:function(f,e){return this.substr(e||0,f.length)===f}})},{}],24:[function(f,h,k){var g=f("../../kern/Kern.js"),e=f("../parsemanager.js"),c=f("../domhelpers.js"),b=f("./staticrouter.js");f=b.extend({constructor:function(a){a=a||{};this._state=layerJS.getState();b.call(this,a);a.cacheCurrent&&(a=c.splitUrl(window.location.href),a.queryString=c.parseStringForTransitions(a.queryString,!0).string,this.addRoute(c.joinUrl(a,!0),this._state.exportState()))},handle:function(a){var f=this,p=new g.Promise;
b.prototype.handle.call(this,a).then(function(b){b.handled||b.optout?p.resolve(b):f._loadHTML(c.joinUrl(a,!0)).then(function(b){e.parseDocument(b);var d={},l=f._state;l.exportStructure().forEach(function(a){a=a.replace(/\$$/,"");d[a]={}});var m=layerJS.getState(b),k=[];m.exportStructure().forEach(function(a){a=a.replace(/\$$/,"");if(!(d[a]||0<k.filter(function(b){return a.startsWith(b)}).length)){var b=!a.match(/\./),c=a.replace(/\.[^\.]*$/,"");if(d[c]||b){var e=m.resolvePath(a)[0].view.outerEl.outerHTML;
b=b?document.body:l.resolvePath(c)[0].view.innerEl;b.insertAdjacentHTML("beforeend",e);b.lastChild.style.display="none";e=b.lastChild.getElementsByTagName("script");for(b=0;b<e.length;b++){c=e[b];var f=document.createElement("script");f.text=c.innerHTML;for(var g=c.attributes.length-1;0<=g;g--)f.setAttribute(c.attributes[g].name,c.attributes[g].value);c.parentNode.replaceChild(f,c)}k.push(a)}else throw"filerouter: didn't find '"+c+"' in current document to add new '"+a+"'";}});0===k.length&&console.warn("layerJS: filerouter: loaded new document '"+
c.joinUrl(a,!0)+"' but didn't add any new content. You should give the frame that should be added a different name or id.");b=m.exportState();var h=b.filter(function(a){var b=a.split(".").pop().startsWith("!"),c=a;b&&(c=a.replace(/\.[^\.]*$/,""));return d.hasOwnProperty(c)||-1!==k.indexOf(c)}),r=h.map(function(){return g._extend({},a.globalTransition)});f.addRoute(c.joinUrl(a,!0),b);c.postAnimationFrame(function(){p.resolve({stop:!1,handled:!0,paths:h,transitions:r})})},function(){p.resolve({stop:!1,
handled:!1,paths:[],transitions:[]})})});return p},_loadHTML:function(a){var b=new g.Promise;try{var c=new XMLHttpRequest;c.onerror=function(){b.reject()};c.onload=function(){if(200===c.status){var a=document.implementation.createHTMLDocument("framedoc");a.documentElement.innerHTML=c.responseText;b.resolve(a)}else b.reject()};c.open("GET",a);c.responseType="text";c.send()}catch(l){b.reject(l)}return b}});h.exports=f},{"../../kern/Kern.js":32,"../domhelpers.js":3,"../parsemanager.js":21,"./staticrouter.js":27}],
25:[function(f,h,k){var g=f("../../kern/Kern.js"),e=f("../domhelpers.js");f=g.EventManager.extend({handle:function(c){var b=new g.Promise;if(void 0===c.hash||"#"===c.hash||""===c.hash)b.resolve({handled:!1,stop:!1,paths:[]});else{for(var a=(c.hash.startsWith("#")?c.hash.substr(1):c.hash).split(";"),f=[],p=[],l=layerJS.getState(),d=function(a){return function(b){return a===b.replace(/\.[^\.]*$/,"")}},n=0;n<a.length;n++){var q=a[n].split("?")[0].split("&")[0].replace("(","").replace(")",""),k=e.parseStringForTransitions(a[n]),
h=!1;try{for(var z=l.resolvePath(q),r=0;r<z.length;r++){var y=z[r];y.hasOwnProperty("frameName")&&y.hasOwnProperty("layer")&&(f.push(y.path),p.push(g._extend(c.globalTransition,k.transition)),h=!0)}}catch(D){}if(!h&&(h=(h=document.getElementsByName(q))&&h[0]||document.getElementById(q))&&"none"!==window.getComputedStyle(h).display&&(r=e.findParentViewOfType(h,"frame"),void 0!==r)){var t=l.buildPath(r.outerEl,!1),u=f.indexOf(t);if(-1!==u)var w=p[u];else if(-1===u&&(t=t.replace(/\.[^\.]*$/,""),t=c.paths.filter(d(t)),
1===t.length)){var x=l.resolvePath(t[0])[0].view;if((q=(q=x.outerEl.querySelectorAll("[name="+q+"], #"+q))&&q[0])&&"none"!==window.getComputedStyle(q).display){var C="none"===window.getComputedStyle(x.outerEl).display;C&&(x.outerEl.style.opacity=0,x.outerEl.style.display="");h=q;u=c.paths.indexOf(t[0]);w=c.transitions[u];h={offsetTop:q.offsetTop,offsetLeft:q.offsetLeft};C&&(x.outerEl.style.display="none",x.outerEl.style.opacity=1)}}-1===u&&r.parent.currentFrame===r&&(f.push(l.buildPath(r.outerEl,
!1)),w=g._extend({},c.globalTransition,k.transition),p.push(w));w&&(w.scrollY=h.offsetTop,w.scrollX=h.offsetLeft)}}b.resolve({stop:!1,handled:0<f.length,paths:f,transitions:p})}return b},buildUrl:function(c){for(var b=layerJS.getState(),a=[],e=0;e<c.state.length;e++){var f=c.state[e].split("."),l=void 0,d=!1;do{l=f.pop()+(l?"."+l:"");var g=b.resolvePath(l);1===g.length&&(d=!0,l=g[0].view&&g[0].view.originalParent&&g[0].view.originalParent!==g[0].view.parent?c.state[e]:l)}while(!d&&0<f.length);d&&
(a.push(l),c.state.splice(e,1),e--)}c.hash=a.join(";")}});h.exports=f},{"../../kern/Kern.js":32,"../domhelpers.js":3}],26:[function(f,h,k){var g=f("../layerjs.js"),e=f("../domhelpers.js"),c=f("../../kern/kern.js"),b=f("./staticrouter.js");f=c.EventManager.extend({constructor:function(a){this._init(a)},_init:function(a){this.rootElement=a||document;this.routers=[];this._registerLinkClickedListener();this.addToHistory=!0;this.isClickEvent=!1;this.state=g.getState();this.state.on("stateChanged",this._stateChanged,
{context:this})},addRouter:function(a){this.routers.push(a);a instanceof b&&(this.staticRouter=a)},clearRouters:function(){this.routers=[]},_registerLinkClickedListener:function(){var a=this;window.onpopstate=function(b){document.location.href===a.ignoreUrl?delete a.ignoreUrl:b&&b.state&&b.state.state?a.state.transitionTo(b.state.state,b.state.transitions,{noHistory:!0}):a.navigate(document.location.href,null,!0)};e.addDelegtedListener(this.rootElement,"click","a:not([data-lj-nolink='true']):not([lj-nolink='true'])",
function(b){if(""!==this.href&&!this.href.startsWith("javascript:")){var c=this.getAttribute("href");b.preventDefault();a.navigate(c,e.findParentViewOfType(this,"layer")).then(function(b){b||setTimeout(function(){a.ignoreUrl=e.getAbsoluteUrl(c);window.location.href=c},1)})}})},navigate:function(a,b,f,l){var d=c._extend(e.splitUrl(a),{transitions:[],context:b,paths:[],globalTransition:{}});if(d.location||d.queryString)d.explLoc=!0,c._extend(d,e.splitUrl(e.getAbsoluteUrl(a)));if(b=d.queryString&&e.parseStringForTransitions(d.queryString,
!1))d.globalTransition=b.transition,d.queryString=b.string;var g=this.routers.length,m=this,p=new c.Promise,h=!1,k=function(){h&&(!0===l?m.state.showState(d.paths,[],{paths:d.paths,transitions:[],noHistory:f,originalUrl:a,initial:l}):m.state.transitionTo(d.paths,d.transitions,{paths:d.paths,transitions:d.transitions,noHistory:f,originalUrl:a}));p.resolve(h)},r=function(a){a<g?m.routers[a].handle(d).then(function(b){b.handled&&(h=b.handled,Array.prototype.push.apply(d.paths,b.paths),Array.prototype.push.apply(d.transitions,
b.transitions));b.handled&&!b.stop||!b.handled?r(a+1):k()}):k()};d.location&&d.location.match(/^\w+:/)&&!d.location.match(new RegExp("^"+window.location.origin))?p.resolve(!1):r(0);return p},_stateChanged:function(a,b){b=b||{};b.state=b.state||[];b.transitions=b.transitions||[];var f=a&&a.exportMinimizedState()||{state:[],defaultState:[],omittedState:[]};a=f.state.concat(f.omittedState).concat(f.defaultState).filter(function(a){return 0>b.state.indexOf(a)&&b.state.indexOf(a.replace("$"))});a=b.state.concat(a);
var l=b.transitions;f=c._extend(e.splitUrl(window.location.href),f);f.queryString=e.parseStringForTransitions(f.queryString,!1).string;for(var d=0;d<this.routers.length;d++)this.routers[d].buildUrl(f);f=e.joinUrl(f);!window.history||b&&b.noHistory||window.location.href===f?!window.history||b&&b.noHistory&&!b.initial||window.history.replaceState({state:a,transitions:l},"",f):window.history.pushState({state:a,transitions:l},"",f)}});h.exports=g.router=new f},{"../../kern/kern.js":33,"../domhelpers.js":3,
"../layerjs.js":7,"./staticrouter.js":27}],27:[function(f,h,k){var g=f("../../kern/kern.js"),e=f("../domhelpers.js");f=g.EventManager.extend({constructor:function(){this.routes={}},addRoute:function(c,b,a){c=e.getAbsoluteUrl(c);a&&this.routes.hasOwnProperty(c)||(this.routes[c]=b)},hasRoute:function(c){c=e.getAbsoluteUrl(c);return this.routes.hasOwnProperty(c)},handle:function(c){var b=e.joinUrl(c,!0),a=!b||!c.explLoc&&e.joinUrl(e.splitUrl(window.location.href),!0)===b;var f=a?!1:this.hasRoute(b);
var p=new g.Promise,l=[],d=[];f&&(l=this.routes[b],l.forEach(function(){d.push(g._extend({},c.globalTransition))}));p.resolve({stop:!1,handled:f,transitions:d,optout:a,paths:l});return p},buildUrl:function(c){var b=c.state.concat(c.defaultState),a=this,f=e.joinUrl(c,!0);var g=f;var l=function(b){return a.routes[f]&&-1!==a.routes[f].indexOf(b)},d=b.filter(l),n=d.length;for(f in this.routes)if(this.routes.hasOwnProperty(f)&&this.routes[f].length>n){var q=b.filter(l),h=q.length;h>n&&(d=q,n=h,g=f)}g=
e.splitUrl(g);c.location=g.location;c.queryString=g.queryString;d.forEach(function(a){var b=c.state.indexOf(a);-1!==b?c.state.splice(b,1):c.defaultState.splice(c.defaultState.indexOf(a),1)})}});h.exports=f},{"../../kern/kern.js":33,"../domhelpers.js":3}],28:[function(f,h,k){var g=f("../kern/Kern.js"),e=f("./domhelpers.js");f=g.EventManager.extend({constructor:function(c){g.EventManager.call(this);var b=this;if(!c)throw"provide a layer";this.layer=c;this.layer.outerEl.addEventListener("scroll",function(){if(b.layer.nativeScroll()){var a=
b.layer.currentFrameTransformData;a.scrollX=b.layer.outerEl.scrollLeft/a.scale;a.scrollY=b.layer.outerEl.scrollTop/a.scale;b.layer.trigger("scroll")}})},scrollTransform:function(c,b){return"translate3d("+c+"px,"+b+"px,0px)"},_detectInnerScrolling:function(c){for(var b=c.event.target;b&&b!==this.layer.innerEl;){if(Math.abs(c.shift.x)>Math.abs(c.shift.y)){if(b.clientWidth<b.scrollWidth&&!(window.getComputedStyle(b)["overflow-x"]in{visible:1,hidden:1})&&(0<c.shift.x&&0<b.scrollLeft||b.scrollLeft<b.scrollWidth-
b.clientWidth))return c.event.stopPropagation(),!0}else if(b.clientHeight<b.scrollHeight&&!(window.getComputedStyle(b)["overflow-y"]in{visible:1,hidden:1})&&(0<c.shift.y&&0<b.scrollTop||b.scrollTop<b.scrollHeight-b.clientHeight))return c.event.stopPropagation(),!0;b=b.parentElement}return!1},scrollGestureListener:function(c){var b=this.layer.currentFrameTransformData;if(c.first)return this.scrollStartX=b.scrollX,this.scrollStartY=b.scrollY,!0;if(this._detectInnerScrolling(c))return!0;var a=Math.abs(c.shift.x)>
Math.abs(c.shift.y)?"x":"y";if("x"===a&&!b.isScrollX||"y"===a&&!b.isScrollY)return!1;if(this.layer.nativeScroll()){if(10>Math.abs(c.shift.x)+Math.abs(c.shift.y))return!0;if("y"===a)return 0<c.shift.y?0<b.scrollY:this.layer.outerEl.scrollHeight-this.layer.outerEl.clientHeight-1>this.layer.outerEl.scrollTop;if("x"===a)return 0<c.shift.x?0<b.scrollX:this.layer.outerEl.scrollWidth-this.layer.outerEl.clientWidth-1>this.layer.outerEl.scrollLeft}else{if("y"===a)if(0<c.shift.y){if(0===b.scrollY)return!1}else{if(1>
b.maxScrollY-b.scrollY)return!1}else if("x"===a)if(0<c.shift.x){if(0===b.scrollX)return!1}else if(1>b.maxScrollX-b.scrollX)return!1;b.scrollX=this.scrollStartX-c.shift.x/b.scale;b.scrollY=this.scrollStartY-c.shift.y/b.scale;b.isScrollX||(b.scrollX=this.scrollStartX);b.isScrollY||(b.scrollY=this.scrollStartY);0>b.scrollX&&(b.scrollX=0);b.scrollX>b.maxScrollX&&(b.scrollX=b.maxScrollX);0>b.scrollY&&(b.scrollY=0);b.scrollY>b.maxScrollY&&(b.scrollY=b.maxScrollY);return this.scrollTransform(-b.scrollX*
b.scale,-b.scrollY*b.scale)}},switchNativeScroll:function(c){},getScrollTransform:function(c,b,a){var f=b.scrollX||c.scrollX,g=b.scrollY||c.scrollY;a||(f=b.scrollX||c.initialScrollX,g=b.scrollY||c.initialScrollY);c.scrollX=void 0!==f?f:c.scrollX;c.scrollY=void 0!==g?g:c.scrollY;c.scrollX>c.maxScrollX&&(c.scrollX=c.maxScrollX);c.scrollY>c.maxScrollY&&(c.scrollY=c.maxScrollY);0>c.scrollX&&(c.scrollX=0);0>c.scrollY&&(c.scrollY=0);if(this.layer.nativeScroll()){if(a)return a=b=0,b=(this.layer.outerEl.scrollLeft||
0)-(c.scrollX*c.scale||0),a=(this.layer.outerEl.scrollTop||0)-(c.scrollY*c.scale||0),this.scrollTransform(b,a);this.layer.innerEl.style.height=c.isScrollY?c.height+"px":"100%";this.layer.innerEl.style.width=c.isScrollX?c.width+"px":"100%";this.layer.outerEl.scrollLeft=c.scrollX*c.scale;this.layer.outerEl.scrollTop=c.scrollY*c.scale;if("ios"===e.browser){this.layer.outerEl.style["-webkit-overflow-scrolling"]="auto";var l=this;setTimeout(function(){l.layer.outerEl.style["-webkit-overflow-scrolling"]=
"touch"},1)}return this.scrollTransform(0,0)}return this.scrollTransform(-c.scrollX*c.scale,-c.scrollY*c.scale)}});h.exports=f},{"../kern/Kern.js":32,"./domhelpers.js":3}],29:[function(f,h,k){k=f("./pluginmanager.js");var g=f("./defaults.js"),e=f("./domhelpers.js"),c=f("./baseview.js"),b=c.extend({constructor:function(a){a=a||{};a.childType="layer";c.call(this,a)},registerEventHandlers:function(){var a=this,b=function(){a.trigger("renderRequired")};c.prototype.registerEventHandlers.call(this);window.addEventListener("resize",
b,!1);this.on("sizeChanged",b)},startObserving:function(){c.prototype.observe.call(this,this.innerEl,{attributes:!0,children:!0,size:!0})},_renderChildPosition:function(a){1===a.nodeType()&&(a.unobserve(),a.outerEl.style.left="0px",a.outerEl.style.top="0px",a.startObserving())},_parseChildren:function(a){var b=this,e=this.autoWidth()||this.autoHeight(),f=function(a){return function(d,c){c=c||{};d=a.currentFrameTransformData;c={transition:c.duration||""};b.autoWidth()?c.width=d.width:b.autoHeight()&&
(c.height=d.height);b.applyStyles(c)}};c.prototype._parseChildren.call(this,a);if(e)for(a=0;a<this._cache.children.length;a++)if(this._cache.children[a].name()===e)this._cache.children[a].on("transitionStarted",f(this._cache.children[a]))}},{defaultProperties:{type:"stage"},identify:function(a){a=e.getAttributeLJ(a,"type");return null!==a&&a.toLowerCase()===b.defaultProperties.type}});k.registerType("stage",b,g.identifyPriority.normal);h.exports=b},{"./baseview.js":1,"./defaults.js":2,"./domhelpers.js":3,
"./pluginmanager.js":22}],30:[function(f,h,k){var g=f("../kern/Kern.js");k=f("./layerjs.js");var e=f("./domhelpers.js"),c=g.EventManager.extend({constructor:function(b){this.document=b||document;this.document._ljState=this;this.viewTypes=["stage","layer","frame"];this.views={};this.layers=[];this.paths={};this._transitionGroup={};g.EventManager.call(this);this.previousState=void 0},registerView:function(b){if(b.document.body.contains(b.outerEl)){var a=b.id();if(this.views[a]){if(this.views[a].view!==
b)throw"state.registerView: duplicate HTML id '"+a+"'";}else{var c=this.buildPath(b.outerEl);this.views[a]={view:b,path:c};var e=this;this.getTrailingPaths(c).forEach(function(b){(e.paths[b]=e.paths[b]||[]).push(a)});"layer"===b.type()&&this.layers.push(a);b.on("childRemoved",function(a){(a.parent&&b.id()===a.parent.id()||void 0===a.parent)&&e.unregisterView(a)},{context:this});b.on("childAdded",function(a){e.views[a.id()]&&e.unregisterView(a);e.registerView(a)},{context:this});b.on("transitionStarted",
function(a,b){var d=!0,c={};if(!b||b.lastFrameName!==a||b.hasOwnProperty("groupId")&&this._transitionGroup.hasOwnProperty(b.groupId))b&&b.hasOwnProperty("groupId")&&this._transitionGroup.hasOwnProperty(b.groupId)&&(this._transitionGroup[b.groupId].length--,b.lastFrameName!==a&&(this._transitionGroup[b.groupId].changed=!0),d=0===this._transitionGroup[b.groupId].length&&this._transitionGroup[b.groupId].changed,c=this._transitionGroup[b.groupId].payload),d&&(!b||b&&!b.isEvent)&&this.trigger("stateChanged",
this,c)},{context:this});b.on("attributesChanged",this._attributesChangedEvent(b),{context:this});b.getChildViews().forEach(function(a){e.registerView(a)})}}},unregisterView:function(b){var a=b.id(),c=this;this.getTrailingPaths(this.views[a].path).forEach(function(b){var d=c.paths[b].indexOf(a);c.paths[b].splice(d,1);0===c.paths[b].length&&delete c.paths[b]});if("layer"===b.type()){var e=this.layers.indexOf(b);this.layers.splice(e,1)}delete this.views[a];b.off(void 0,void 0,this);b.getChildViews().forEach(function(a){c.unregisterView(a)})},
exportState:function(){return this._exportState().state},exportMinimizedState:function(){return this._exportState(!0)},_exportState:function(b){b=b||!1;var a={state:[],defaultState:[],omittedState:[]},c=this;c.exportStructure("frame").forEach(function(e){var f=e.endsWith("$"),d=e;f&&(d=d.substr(0,d.length-1));d=c.paths[d];if(1<d.length)throw"state.exportState: multiple frames found for "+e;d=c.views[d[0]].view;var g=d.parent;d===g.currentFrame?!0===b&&g.noUrl()?a.omittedState.push(e):!0===b&&(g.currentFrame.name()===
g.defaultFrame()||null===g.defaultFrame()&&null===g.currentFrame.outerEl.previousElementSibling)?a.defaultState.push(e):a.state.push(e):f&&d.parent!==d.originalParent?a.state.push(e):f&&a.omittedState.push(e)});this.layers.map(function(a){return c.views[a].view}).filter(function(a){return null===a.currentFrame||void 0===a.currentFrame}).forEach(function(e){!0===b&&e.noUrl()?a.omittedState.push(c.views[e.id()].path+".!none"):!0===b&&"!none"===e.defaultFrame()?a.defaultState.push(c.views[e.id()].path+
".!none"):a.state.push(c.views[e.id()].path+".!none")});return a},exportStructure:function(b){var a=this,c=Object.keys(this.views).map(function(b){return a.views[b].view.outerEl}).sort(e.comparePosition);b&&(c=c.filter(function(a){return a._ljView.type()===b}));return c.map(function(b){var c=!0;"frame"===b._ljView.type()&&(c=b._ljView,c=c.parent.currentFrame===c);return a.views[b._ljView.id()].path+(c?"":"$")})},transitionTo:function(b,a,c){this._transitionTo(!1,b,a,c)},showState:function(b,a,c){return this._transitionTo(!0,
b,a,c)},_transitionTo:function(b,a,c,f){var l=this;c=c||[];f=f||{};f.state=a;f.transitions=c.map(function(a){return g._extend({},a)});var d={},n={},m={},h=function(a){var b=d[a].layer.id();m=d[a].transition;delete d[a];delete n[b]};a.map(function(a){return l.resolvePath(a)}).forEach(function(a,b){for(var e=0;e<a.length;e++){var f=a[e],l=f.layer.id();m={};var k=g._extend(m,c[Math.min(b,c.length-1)]||{});!0!==f.noActivation&&(f.isInterStage&&d.hasOwnProperty(f.originalPath)&&h(f.originalPath),d.hasOwnProperty(f.path)&&
h(f.path),n.hasOwnProperty(l)&&h(n[l]),n[l]=f.path);if(!0!==f.noActivation||f.isInterStage)d[f.path]={layer:f.layer,frameName:f.frameName,transition:g._extend({noActivation:f.noActivation},m,k)}}});a=Object.getOwnPropertyNames(d);var k=new g.Semaphore(a.length),p=e.uniqueID("group");this._transitionGroup[p]={length:a.length,payload:f};for(f=0;f<a.length;f++){var r=d[a[f]];r.transition.semaphore=k;r.transition.groupId=p;b?r.layer.showFrame(r.frameName,r.transition):r.layer.transitionTo(r.frameName,
r.transition)}return 0<c.length},buildPath:function(b,a){if(!b)return"";if(!b._ljView)return this.buildPath(b.parentNode);var c=b._ljView.parent;a=!a&&c?this.views[c.id()].path:this.buildPath(b.parentNode);""!==a&&(a+=".");return a+b._ljView.name()},getTrailingPaths:function(b){for(var a=[b];b=b.replace(/^[^\.]*\.?/,"");)a.push(b);return a},resolvePath:function(b,a){var c=b.endsWith("$");c&&(b=b.substr(0,b.length-1));var e=a&&this.buildPath(a),f=b.split(".");a=f.pop();var d="!"===a[0];var g=f.join(".");
f=d?g?this.paths[g]:this.layers:this.paths[b];d||f&&0!==f.length||!g||(f=this.paths[g]);if(!f||0===f.length)return[];if(1<f.length&&e){for(var h=[];0===h.length&&e;){for(g=0;g<f.length;g++)this.views[f[g]].path.startsWith(e)&&h.push(f[g]);e=e.replace(/\.?[^\.]$/,"")}f=h.length?h:f}e=[];for(g=0;g<f.length;g++){h=this.views[f[g]].view;var k=this.views[f[g]].path;if(d){if("layer"!==h.type())throw"state: expected layer name in front of '"+a+"'";e.push({layer:h,frameName:a,path:k+"."+a+(c?"$":"")})}else if("frame"===
h.type())e.push({layer:h.parent,view:h,frameName:a,path:k+(c?"$":""),active:void 0!==h.parent.currentFrame&&null!==h.parent.currentFrame?h.parent.currentFrame.name()===a:!1,noActivation:c});else if("layer"===h.type())if(k.endsWith(b))e.push({view:h,path:k});else{var v=this.resolvePath(a);1===v.length&&e.push({layer:h,frameName:a,view:v[0].view,path:k+"."+a+(c?"$":""),active:!1,isInterStage:!0,originalPath:v[0].path,noActivation:c})}else e.push({view:h,path:k})}return e},_attributesChangedEvent:function(b){var a=
this;return function(c){if(c["lj-name"]||c["data-lj-name"]||c.id)a.unregisterView(b),a.registerView(b)}}});k.getState=function(b){b=b||document;return b._ljState||new c(b)};h.exports=c},{"../kern/Kern.js":32,"./domhelpers.js":3,"./layerjs.js":7}],31:[function(f,h,k){var g=function(e){e instanceof Array?(this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.tx=e[4],this.ty=e[5]):(this.a=this.d=1,this.b=this.c=this.tx=this.ty=0)};g.prototype={prod:function(e){return new g([this.a*e.a+this.b*e.c,this.a*
e.b+this.b*e.d,this.c*e.a+this.d*e.c,this.c*e.b+this.d*e.d,this.a*e.tx+this.b*e.ty+this.tx,this.c*e.tx+this.d*e.ty+this.ty])},transform:function(){return"matrix("+this.a.toFixed(4)+","+this.c.toFixed(4)+","+this.b.toFixed(4)+","+this.d.toFixed(4)+","+this.tx.toFixed(4)+","+this.ty.toFixed(4)+")"},transform_nomatrix:function(e){var c=this.get_translation_equal(),b=this.get_scale_equal(),a=this.get_rotation_equal();c=g.Tscale(0<b?1/b:b).prod(g.Trot(-a)).transform_vec(c);1E-6>Math.abs(c.x)&&(c.x=0);
1E-6>Math.abs(c.y)&&(c.y=0);return"scale("+this.get_scale_equal()+") rotate("+(this.get_rotation_equal()+(e?e:0))+"deg) "+g.getTranslateString(c.x,c.y)},transform_vec:function(e){return{x:this.a*e.x+this.b*e.y+this.tx,y:this.c*e.x+this.d*e.y+this.ty}},invert:function(){var e=1/(this.a*this.d-this.b*this.c||1),c=e*this.d,b=-e*this.b,a=-e*this.c;e*=this.a;return new g([c,b,a,e,-c*this.tx-b*this.ty,-a*this.tx-e*this.ty])},get_scale_equal:function(){var e=this.a,c=this.c;return Math.sqrt(e*e+c*c)},get_rotation_equal:function(){return 180/
Math.PI*Math.atan2(this.b,this.a)},get_translation_equal:function(){return{x:this.tx,y:this.ty}},set_scale_equal:function(e){var c=this.get_scale_equal();this.a*=e/c;this.b*=e/c;this.c*=e/c;this.d*=e/c},copy:function(){return new g([this.a,this.b,this.c,this.d,this.tx,this.ty])},clearShift:function(){this.ty=this.tx=0;return this}};g.Trot=function(e){e=e*Math.PI/180;return new g([Math.cos(e),-Math.sin(e),Math.sin(e),Math.cos(e),0,0])};g.Tscale=function(e){return new g([e,0,0,e,0,0])};g.Tscalexy=function(e,
c){return new g([e,0,0,c,0,0])};g.Ttrans=function(e,c){return new g([1,0,0,1,e,c])};g.Tall=function(e,c,b,a){a=a*Math.PI/180;return new g([b*Math.cos(a),-b*Math.sin(a),b*Math.sin(a),b*Math.cos(a),e,c])};g.getTranslateString=function(e,c){return"translate3d("+e+"px,"+c+"px,0)"};h.exports=g},{}],32:[function(f,h,k){(function(){var f=function(){function f(a,b){return(new Function("c","return function "+a+"(){c.apply(this, arguments)}"))(b)}var c=function(a){var b=arguments.length;if(2>b)throw"too few arguments in _extend";
if(null===a)throw"no object provided in _extend";for(var c=1;c<b;c++)for(var f=Object.keys(arguments[c]),e=0;e<f.length;e++)a[f[e]]=arguments[c][f[e]];return a},b=function(a){if("object"===typeof a){if(Array.isArray(a)){var d=[];for(var c=a.length-1;0<=c;c--)d[c]=b(a[c]);return d}if(null===a)return null;d={};for(c in Object.keys(a))a.hasOwnProperty(c)&&(d[c]=b(a[c]));return d}return a},a={_extend:c,_extendKeep:function(a){var b=arguments.length;if(2>b)throw"too few arguments in _extend";if(null===
a)throw"no object provided in _extend";for(var c=1;c<b;c++)for(var f=Object.keys(arguments[c]),e=0;e<f.length;e++)a.hasOwnProperty(f[e])||(a[f[e]]=arguments[c][f[e]]);return a},_extendKeepDeepCopy:function(a){var c=arguments.length;if(2>c)throw"too few arguments in _extend";if(null===a)throw"no object provided in _extend";for(var f=1;f<c;f++)for(var e=Object.keys(arguments[f]),g=0;g<e.length;g++)a.hasOwnProperty(e[g])||(a[e[g]]=b(arguments[f][e[g]]));return a}},g=a.Base=function(){};g.extend=function(a,
b){a=a||{};b=b||{};var d=this,e=a.hasOwnProperty("constructor")?a.constructor:function(){return d.apply(this,arguments)};b&&b.className&&(e=f(b.className,e));delete a.constructor;e.prototype=Object.create(d.prototype);e.prototype.constructor=e;c(e.prototype,a);c(e,this,b);return e};a.EventManager=g.extend({constructor:function(){this.__listeners__={}},on:function(a,b,c){this.__listeners__[a]=this.__listeners__[a]||[];this.__listeners__[a].push({callback:b,options:c||{}});return this},once:function(a,
b,c){var d=this,e=function(){b.apply(this,arguments);d.off(a,e)};this.on(a,e,c);return this},off:function(a,b,c){if(a)if(b||c){var d=this.__listeners__[a];for(a=0;a<d.length;a++)b&&d[a].callback!==b||c&&d[a].options.context!==c||d.splice(a,1)}else delete this.__listeners__[a];else if(b||c)for(var e in this.__listeners__){if(this.__listeners__.hasOwnProperty(e))for(d=this.__listeners__[e],a=0;a<d.length;a++)b&&d[a].callback!==b||c&&d[a].options.context!==c||d.splice(a,1)}else this.__listeners__={};
return this},trigger:function(a){if(this.__listeners__[a])for(var b=0;b<this.__listeners__[a].length;b++){for(var c=arguments.length,e=Array(c-1),f=0;f<c-1;f++)e[f]=arguments[f+1];c=this.__listeners__[a][b];c.callback.apply(c.options.context||this,e)}return this},triggerBy:function(a,b){if(this.__listeners__[b])for(var c=0;c<this.__listeners__[b].length;c++)if(!this.__listeners__[b][c].options.ignoreSender||this.__listeners__[b][c].options.ignoreSender!==a){for(var d=arguments.length,e=Array(d-2),
f=0;f<d-2;f++)e[f]=arguments[f+2];d=this.__listeners__[b][c];d.callback.apply(d.options.context||this,e)}return this}});var h=a.Promise=g.extend({constructor:function(){this.reason=this.value=this.state=void 0},then:function(a,b){this.nextPromise=new h;this.fn=a;this.errFn=b;void 0!==this.state&&this.execute();return this.nextPromise},resolve:function(a){if(void 0!==this.state)console.warn("Promise: double resolve/reject (ignored).");else return this.state=!0,this.value=a,this.execute(),this},reject:function(a){if(void 0!==
this.state)console.warn("Promise: double resolve/reject (ignored).");else return this.state=!1,this.reason=a,this.execute(),this},execute:function(){if(this.nextPromise){var a=this;if(!0===this.state){if(this.fn)try{var b=this.fn(this.value);b instanceof h?b.then(function(b){a.nextPromise.resolve(b)},function(b){a.nextPromise.reject(b)}):a.nextPromise.resolve(b)}catch(n){console.log("in Promise handler:",n),this.nextPromise.reject(n)}}else!1===this.state&&(this.errFn&&this.errFn(this.reason),this.nextPromise.reject(this.reason))}}});
a.Semaphore=g.extend({constructor:function(a){this.num=a||0;this.cc=0;this.ps=[];this.ls=[];this.ls2=[]},register:function(){this.num++;return this},listen:function(b){var c=new a.Promise;b?this.ls.push(c):this.ls2.push(c);return c},skip:function(){this.num--;if(0>this.num)throw"semaphore: skipped stakeholder that was not registered";this.num===this.cc&&(this.cc--,this.sync())},sync:function(){var b;this.cc++;this.ps.push(b=new a.Promise);if(this.cc===this.num){for(var c=0;c<this.ls.length;c++)this.ls[c].resolve(this.num);
for(c=0;c<this.ps.length;c++)this.ps[c].resolve(this.num);var e=this;setTimeout(function(){for(var a=0;a<e.ls2.length;a++)e.ls2[a].resolve(e.num)},0)}else if(this.cc>=this.num)throw"semaphore: more syncs than stakeholders";return b}});a.Queue=g.extend({constructor:function(){this.q=[];this.waiting=!1},add:function(b){var c=new a.Promise;if(this.waiting){var e=0<this.q.length&&b===this.q[this.q.length-1].category;void 0!==b&&e&&this.q.pop().promise.reject();this.q.push({promise:c,category:b})}else c.resolve(),
this.waiting=!0;return c},continue:function(){this.q.length?this.q.shift().promise.resolve():this.waiting=!1},clear:function(){for(;0<this.q.length;)this.q.shift().promise.reject();this.waiting=!1}});return a};"function"===typeof define&&define.amd?define("Kern",[],f):"undefined"!==typeof h&&h.exports?(f=f(),h.exports=f):window.Kern=f()})()},{}],33:[function(f,h,k){arguments[4][32][0].apply(k,arguments)},{dup:32}],34:[function(f,h,k){f("./kern/kern.js");f("./framework/layerjs.js");f("./framework/state.js");
f("./framework/pluginmanager.js");f("./framework/layoutmanager.js");f("./framework/parsemanager.js");f("./framework/layouts/layerlayout.js");f("./framework/layouts/slidelayout.js");f("./framework/layouts/canvaslayout.js");f("./framework/gestures/gesturemanager.js");f("./framework/router/router.js");f("./framework/defaults.js");f("./framework/layerview.js");f("./framework/frameview.js");f("./framework/stageview.js");var g=window.location.href,e=f("./framework/router/filerouter.js"),c=f("./framework/router/hashrouter.js"),
b=f("./framework/domhelpers.js"),a=!1;layerJS.init=function(){if(!a){a=!0;layerJS.parseManager.parseDocument();var f=b.getAttributeLJ(document.body,"router");f&&"filerouter"===f.toLowerCase()&&layerJS.router.addRouter(new e({cacheCurrent:!0}));layerJS.router.addRouter(new c);layerJS.router.navigate(g,null,!0,!0).then(function(){})}};"interactive"===document.readyState?b.getAttributeLJ(document.body,"no-init")||a||layerJS.init():document.addEventListener("DOMContentLoaded",function(){b.getAttributeLJ(document.body,
"no-init")||a||layerJS.init()});console.log("*** layerJS *** checkout http://layerjs.org *** happy to help you: developers@layerjs.org ***")},{"./framework/defaults.js":2,"./framework/domhelpers.js":3,"./framework/frameview.js":4,"./framework/gestures/gesturemanager.js":6,"./framework/layerjs.js":7,"./framework/layerview.js":8,"./framework/layoutmanager.js":9,"./framework/layouts/canvaslayout.js":10,"./framework/layouts/layerlayout.js":11,"./framework/layouts/slidelayout.js":12,"./framework/parsemanager.js":21,
"./framework/pluginmanager.js":22,"./framework/router/filerouter.js":24,"./framework/router/hashrouter.js":25,"./framework/router/router.js":26,"./framework/stageview.js":29,"./framework/state.js":30,"./kern/kern.js":33}]},{},[34]);